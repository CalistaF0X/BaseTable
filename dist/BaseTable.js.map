{
  "version": 3,
  "sources": ["../BaseTable/Table.js", "../BaseTable/Modal.js", "../BaseTable/Fetcher.js", "../BaseTable/RendererRegistry.js", "../BaseTable/BaseTable.js"],
  "sourcesContent": ["/**\r\n * BaseTable\r\n * Table build utilities\r\n *\r\n * @author {string} Calista Verner\r\n * @version 1.4.2\r\n * @license MIT\r\n */\r\n\r\nexport class Table {\r\n\r\n    constructor(baseTable) {\r\n        this.baseTable = baseTable;\r\n    }\r\n\r\n    createRowFromData(row) {\r\n        const tr = document.createElement('tr');\r\n        if (row[this.baseTable.idField] !== undefined) tr.dataset.id = String(row[this.baseTable.idField]);\r\n\r\n        for (const col of this.baseTable.columns) {\r\n            const td = document.createElement('td');\r\n            if (col.className) td.className = col.className;\r\n            if (col.width) td.style.width = col.width;\r\n            if (col.attrs && typeof col.attrs === 'object') {\r\n                Object.entries(col.attrs).forEach(([k, v]) => td.setAttribute(k, v));\r\n            }\r\n\r\n            const val = this.getByPath(row, col.key);\r\n\r\n            if (typeof col.renderer === 'function') {\r\n                try {\r\n                    const out = col.renderer(val, row, {\r\n                        table: this.baseTable,\r\n                        col\r\n                    });\r\n                    if (typeof out === 'string') td.innerHTML = out;\r\n                    else if (out instanceof Node) td.appendChild(out);\r\n                    else td.textContent = out ?? '';\r\n                } catch (e) {\r\n                    this.baseTable.error('col.renderer error', e);\r\n                    td.textContent = String(val ?? '');\r\n                }\r\n                tr.appendChild(td);\r\n                continue;\r\n            }\r\n\r\n            const type = col.type || this._inferTypeFromValue(val);\r\n            const renderer = this.baseTable.typeRenderers.get(type);\r\n            if (typeof renderer !== 'function') {\r\n                td.textContent = String(val ?? '');\r\n                tr.appendChild(td);\r\n                continue;\r\n            }\r\n\r\n            try {\r\n                renderer.call(this.baseTable, td, val, col, row, {\r\n                    escapeHtml: BaseTable.escapeHtml,\r\n                    formatPrice: this.formatPrice?.bind(this.baseTable)\r\n                });\r\n            } catch (e) {\r\n                this.baseTable.error('type renderer error', e);\r\n                td.textContent = String(val ?? '');\r\n            }\r\n\r\n            tr.appendChild(td);\r\n        }\r\n\r\n        if (this.baseTable.actions && this.baseTable.actions.length) {\r\n            const tdActions = document.createElement('td');\r\n            tdActions.className = 'text-end';\r\n            for (const a of this.baseTable.actions) {\r\n                const btn = document.createElement('button');\r\n                btn.type = 'button';\r\n                btn.className = a.className || 'btn btn-sm btn-outline-secondary';\r\n                btn.textContent = a.label;\r\n                if (a.title) btn.title = a.title;\r\n                if (a.action) btn.dataset.action = a.action;\r\n                btn.dataset.id = row[this.baseTable.idField];\r\n                if (a.attrs) Object.entries(a.attrs).forEach(([k, v]) => btn.setAttribute(k, v));\r\n                tdActions.appendChild(btn);\r\n                if (typeof a.after === 'function') {\r\n                    try {\r\n                        a.after(btn, row);\r\n                    } catch (e) {\r\n                        this.baseTable.error('action.after', e);\r\n                    }\r\n                }\r\n            }\r\n            tr.appendChild(tdActions);\r\n        }\r\n\r\n        return tr;\r\n    }\r\n\r\n    getByPath(obj, path) {\r\n        if (!obj || !path) return undefined;\r\n        if (path.indexOf('.') === -1) return obj[path];\r\n        return path.split('.').reduce((cur, p) => (cur && cur[p] !== undefined ? cur[p] : undefined), obj);\r\n    }\r\n\r\n    _inferTypeFromValue(val) {\r\n        if (val == null) return 'text';\r\n        if (typeof val === 'boolean') return 'boolean';\r\n        if (typeof val === 'number') return 'number';\r\n        if (val instanceof Date) return 'date';\r\n        const s = String(val);\r\n        if (/^\\d{4}-\\d{2}-\\d{2}T/.test(s) || /^\\d{4}-\\d{2}-\\d{2}/.test(s) || /^\\d{10,13}$/.test(s)) return 'date';\r\n        if (/\\.(png|jpe?g|gif|webp|svg)(\\?.*)?$/i.test(s)) return 'image';\r\n        if (/^https?:\\/\\//i.test(s) || /^mailto:/i.test(s) || /^\\/\\//.test(s)) return 'link';\r\n        return 'text';\r\n    }\r\n\r\n    formatPrice(v) {\r\n        if (v === null || v === undefined || v === '') return '\u2014';\r\n        const n = Number(v);\r\n        if (Number.isNaN(n)) return String(v);\r\n        return n.toLocaleString('ru-RU', {\r\n            minimumFractionDigits: 0,\r\n            maximumFractionDigits: 2\r\n        });\r\n    }\r\n\r\n    _buildFormFromSchema(item = {}) {\r\n        if (typeof this.baseTable.ui.formBuilder === 'function') {\r\n            try {\r\n                return this.baseTable.ui.formBuilder(this.baseTable.formSchema, item, this.baseTable.refs, {\r\n                    placeholderSVG: this.baseTable.placeholderSVG.bind(this.baseTable)\r\n                });\r\n            } catch (e) {\r\n                this.baseTable.error('ui.formBuilder error', e);\r\n            }\r\n        }\r\n\r\n        const form = document.createElement('form');\r\n        form.className = 'bt-dynamic-form pe-form';\r\n\r\n        const grid = document.createElement('div');\r\n        grid.className = 'bt-form-grid';\r\n\r\n        if (!document.getElementById('bt-form-grid-style')) {\r\n            const mediaStyle = document.createElement('style');\r\n            mediaStyle.id = 'bt-form-grid-style';\r\n            mediaStyle.textContent = `.bt-form-grid { display: grid; gap: 12px; grid-template-columns: 1fr 1fr; } @media (max-width: 720px) { .bt-form-grid { grid-template-columns: 1fr; } }`;\r\n            document.head.appendChild(mediaStyle);\r\n        }\r\n\r\n        const fieldMap = {};\r\n        const groups = {};\r\n        (this.baseTable.formSchema || []).forEach(f => {\r\n            const g = f.group || '__default';\r\n            if (!groups[g])\r\n                groups[g] = [];\r\n            groups[g].push(f);\r\n        });\r\n\r\n        const makeFieldCard = (title) => {\r\n            const card = document.createElement('div');\r\n            card.className = 'bt-field-card';\r\n            Object.assign(card.style, {\r\n                padding: '10px',\r\n                borderRadius: '10px',\r\n                background: '#fff',\r\n                border: '1px solid #eef4fb',\r\n                boxShadow: '0 6px 18px rgba(12,20,40,0.02)'\r\n            });\r\n            return card;\r\n        };\r\n\r\n        const makeRow = (field) => {\r\n            const wrap = document.createElement('div');\r\n            wrap.className = 'bt-form-row';\r\n\r\n            if (field.type !== 'hidden') {\r\n                const labelRow = document.createElement('div');\r\n                Object.assign(labelRow.style, {\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center'\r\n                });\r\n                const label = document.createElement('label');\r\n                label.className = 'form-label';\r\n                label.textContent = field.label || field.name || '';\r\n                Object.assign(label.style, {\r\n                    fontWeight: 600,\r\n                    fontSize: '0.95rem'\r\n                });\r\n                labelRow.appendChild(label);\r\n                if (field.hint) {\r\n                    const hint = document.createElement('div');\r\n                    hint.className = 'form-hint';\r\n                    hint.textContent = field.hint;\r\n                    Object.assign(hint.style, {\r\n                        fontSize: '0.82rem',\r\n                        color: '#6b7280'\r\n                    });\r\n                    labelRow.appendChild(hint);\r\n                }\r\n                if (field.required) {\r\n                    const star = document.createElement('span');\r\n                    star.style.color = '#ef4444';\r\n                    star.textContent = ' *';\r\n                    label.appendChild(star);\r\n                }\r\n                wrap.appendChild(labelRow);\r\n            }\r\n\r\n            let control;\r\n            const attrs = field.attrs || {};\r\n            switch (field.type) {\r\n                case 'textarea':\r\n                    control = document.createElement('textarea');\r\n                    control.rows = attrs.rows || 4;\r\n                    control.className = attrs.className || 'form-control';\r\n                    if (field.placeholder)\r\n                        control.placeholder = field.placeholder;\r\n                    break;\r\n\r\n                case 'number':\r\n                    control = document.createElement('input');\r\n                    control.type = 'number';\r\n                    control.className = attrs.className || 'form-control';\r\n                    if (field.placeholder)\r\n                        control.placeholder = field.placeholder;\r\n                    if (attrs.min !== undefined)\r\n                        control.min = attrs.min;\r\n                    if (attrs.step !== undefined)\r\n                        control.step = attrs.step;\r\n                    break;\r\n\r\n                case 'price': {\r\n                    // wrapper (bootstrap-like input-group)\r\n                    const wrapper = document.createElement('div');\r\n                    wrapper.className = attrs.wrapperClass || 'input-group';\r\n\r\n                    // currency symbol (from field.currency or options.currency)\r\n                    const currencyCode = (field.currency || this.baseTable.options.currency || 'RUB').toUpperCase();\r\n                    const currencySymbols = {\r\n                        RUB: '\u20BD',\r\n                        RUBLES: '\u20BD',\r\n                        USD: '$',\r\n                        EUR: '\u20AC',\r\n                        GBP: '\u00A3'\r\n                    };\r\n                    const currencySign = field.currencySign || (currencySymbols[currencyCode] || currencyCode);\r\n\r\n                    const prefix = document.createElement('span');\r\n                    prefix.className = attrs.prefixClass || 'input-group-text';\r\n                    prefix.setAttribute('aria-hidden', 'true');\r\n                    prefix.textContent = currencySign;\r\n\r\n                    // visible (formatted) input for user interaction\r\n                    const visible = document.createElement('input');\r\n                    visible.type = 'text';\r\n                    visible.className = (attrs.className ? attrs.className + ' ' : '') + 'form-control bt-field-price-visible';\r\n                    if (field.placeholder)\r\n                        visible.placeholder = field.placeholder;\r\n                    visible.setAttribute('inputmode', 'numeric');\r\n                    visible.setAttribute('autocomplete', 'off');\r\n                    visible.setAttribute('aria-label', field.label || field.name || '\u0426\u0435\u043D\u0430');\r\n\r\n                    // hidden input that will actually carry the numeric value for the form\r\n                    const hidden = document.createElement('input');\r\n                    hidden.type = 'hidden';\r\n                    // name will be set on hidden below via fieldMap assignment (so form submits numeric value)\r\n                    hidden.className = 'bt-field-price-hidden';\r\n\r\n                    // append to wrapper\r\n                    wrapper.appendChild(prefix);\r\n                    wrapper.appendChild(visible);\r\n                    wrapper.appendChild(hidden);\r\n\r\n                    // helper: parse formatted string -> number\r\n                    const parseToNumber = (s) => {\r\n                        if (s === '' || s === null || s === undefined)\r\n                            return null;\r\n                        try {\r\n                            const cleaned = String(s).replace(/\\s+/g, '').replace(/\\u00A0/g, '').replace(',', '.').replace(/[^0-9.\\-]/g, '');\r\n                            const n = Number(cleaned);\r\n                            return Number.isFinite(n) ? n : null;\r\n                        } catch (e) {\r\n                            return null;\r\n                        }\r\n                    };\r\n\r\n                    // sync visible -> hidden (set hidden.value as raw numeric string; set data-raw on visible)\r\n                    const syncToHidden = (valStr) => {\r\n                        const n = parseToNumber(valStr);\r\n                        if (n === null) {\r\n                            hidden.value = '';\r\n                            visible.removeAttribute('data-raw');\r\n                        } else {\r\n                            // keep integer if user wants 0 decimals; allow fraction if provided (field.precision)\r\n                            const precision = Number.isFinite(field.precision) ? Math.max(0, field.precision) : 0;\r\n                            const raw = precision ? (Math.round(n * Math.pow(10, precision)) / Math.pow(10, precision)) : Math.trunc(n);\r\n                            hidden.value = String(raw);\r\n                            visible.setAttribute('data-raw', String(raw));\r\n                        }\r\n                    };\r\n\r\n                    // try to prefer jQuery plugins if available\r\n                    let pluginApplied = false;\r\n                    const initialVal = item[field.name];\r\n\r\n                    try {\r\n                        if (window.jQuery) {\r\n                            const $v = jQuery(visible);\r\n\r\n                            // maskMoney (common for currency)\r\n                            if (typeof jQuery.fn.maskMoney === 'function') {\r\n                                $v.maskMoney({\r\n                                    thousands: ' ',\r\n                                    decimal: ',',\r\n                                    allowZero: true,\r\n                                    precision: field.precision ?? 0\r\n                                });\r\n                                if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') {\r\n                                    const num = Number(String(initialVal).toString().replace(/\\s+/g, '').replace(',', '.')) || 0;\r\n                                    $v.maskMoney('mask', num);\r\n                                    syncToHidden(String(num));\r\n                                } else {\r\n                                    $v.maskMoney('mask');\r\n                                }\r\n                                // update hidden on change/input\r\n                                $v.on('mask.maskMoney input change', () => {\r\n                                    syncToHidden($v.val());\r\n                                });\r\n                                pluginApplied = true;\r\n                            } // jQuery Mask plugin (RobinHerbots jQuery Mask) \u2014 supports reverse option\r\n                            else if (typeof jQuery.fn.mask === 'function') {\r\n                                try {\r\n                                    $v.mask('000 000 000 000 000', {\r\n                                        reverse: true\r\n                                    });\r\n                                } catch (e) {\r\n                                    // fallback mask pattern if plugin expects different signature\r\n                                    $v.mask('999 999 999 999 999', {\r\n                                        reverse: true\r\n                                    });\r\n                                }\r\n                                if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') {\r\n                                    $v.val(String(initialVal)).trigger('input');\r\n                                    syncToHidden($v.val());\r\n                                }\r\n                                $v.on('input change', () => syncToHidden($v.val()));\r\n                                pluginApplied = true;\r\n                            } // maskedInput (older plugin names) \u2014 try common fn name\r\n                            else if (typeof jQuery.fn.maskedInput === 'function' || typeof jQuery.fn.masked === 'function') {\r\n                                // best-effort: apply a numeric mask (not ideal for arbitrary length)\r\n                                try {\r\n                                    if (typeof jQuery.fn.maskedInput === 'function')\r\n                                        jQuery(visible).maskedInput('999999999999');\r\n                                    else\r\n                                        jQuery(visible).masked('999999999999');\r\n                                } catch (e) {}\r\n                                if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') {\r\n                                    $v.val(String(initialVal)).trigger('input');\r\n                                    syncToHidden($v.val());\r\n                                }\r\n                                $v.on('input change', () => syncToHidden($v.val()));\r\n                                pluginApplied = true;\r\n                            }\r\n                        }\r\n                    } catch (e) {\r\n                        // plugin error -> fallback to JS handler below\r\n                        pluginApplied = false;\r\n                    }\r\n\r\n                    // fallback: simple live formatter (thousands by spaces) if plugin not applied\r\n                    const liveHandler = (ev) => {\r\n                        const raw = String(visible.value || '').replace(/\\s+/g, '').replace(/[^\\d,.-]/g, '').replace(',', '.');\r\n                        const num = parseToNumber(raw);\r\n                        if (num === null) {\r\n                            // keep user input but don't break caret too much\r\n                            syncToHidden(visible.value);\r\n                            return;\r\n                        }\r\n                        // format to locale-like thousands with no decimals by default (or keep precision)\r\n                        const precision = Number.isFinite(field.precision) ? Math.max(0, field.precision) : 0;\r\n                        let display;\r\n                        try {\r\n                            if (precision > 0)\r\n                                display = num.toLocaleString('ru-RU', {\r\n                                    minimumFractionDigits: precision,\r\n                                    maximumFractionDigits: precision\r\n                                });\r\n                            else\r\n                                display = Math.trunc(num).toLocaleString('ru-RU');\r\n                        } catch (e) {\r\n                            display = String(Math.trunc(num)).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\r\n                        }\r\n\r\n                        // try to preserve caret by setting to end (simple)\r\n                        visible.value = display;\r\n                        try {\r\n                            visible.setSelectionRange(visible.value.length, visible.value.length);\r\n                        } catch (_) {}\r\n                        syncToHidden(display);\r\n                    };\r\n\r\n                    if (!pluginApplied) {\r\n                        visible.addEventListener('input', liveHandler);\r\n                        this.baseTable._listeners.push({\r\n                            el: visible,\r\n                            ev: 'input',\r\n                            fn: liveHandler\r\n                        });\r\n                        // format initial\r\n                        try {\r\n                            if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') {\r\n                                const n = parseToNumber(String(initialVal));\r\n                                if (n !== null) {\r\n                                    const precision = Number.isFinite(field.precision) ? Math.max(0, field.precision) : 0;\r\n                                    visible.value = precision > 0 ? n.toLocaleString('ru-RU', {\r\n                                        minimumFractionDigits: precision,\r\n                                        maximumFractionDigits: precision\r\n                                    }) : Math.trunc(n).toLocaleString('ru-RU');\r\n                                    syncToHidden(visible.value);\r\n                                } else {\r\n                                    visible.value = String(initialVal);\r\n                                    syncToHidden(visible.value);\r\n                                }\r\n                            }\r\n                        } catch (e) {}\r\n                    }\r\n\r\n                    // when clicking prefix focus visible input\r\n                    prefix.addEventListener('click', () => {\r\n                        try {\r\n                            visible.focus();\r\n                        } catch (e) {}\r\n                    });\r\n                    this.baseTable._listeners.push({\r\n                        el: prefix,\r\n                        ev: 'click',\r\n                        fn: () => {\r\n                            try {\r\n                                visible.focus();\r\n                            } catch (e) {}\r\n                        }\r\n                    });\r\n\r\n                    // expose visible as the UI control for population, but the hidden carries the name\r\n                    // we must register both in fieldMap: visible for UI updates, hidden for form data\r\n                    fieldMap[field.name] = visible;\r\n                    // later population code will use visible (formatting)\r\n                    // set hidden's name so FormData uses numeric value\r\n                    hidden.name = field.name;\r\n                    // also set ids for both (use distinct ids)\r\n                    visible.id = `bt-field-${field.name}-visible`;\r\n                    hidden.id = `bt-field-${field.name}`;\r\n                    // append wrapper to DOM in place of simple control\r\n                    wrap.appendChild(wrapper);\r\n                    // note: `wrap` is outer row element created earlier in makeRow\r\n                    // return early like select case (so global post-switch name/id/aria setting is not applied to visible)\r\n                    return wrap;\r\n                }\r\n\r\n                case 'select': {\r\n                    const selectWrap = document.createElement('div');\r\n                    Object.assign(selectWrap.style, {\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        gap: '6px'\r\n                    });\r\n                    let searchInput = null;\r\n                    if (field.searchable) {\r\n                        searchInput = document.createElement('input');\r\n                        searchInput.type = 'search';\r\n                        searchInput.placeholder = '\u041F\u043E\u0438\u0441\u043A...';\r\n                        searchInput.className = 'form-control form-control-sm';\r\n                        searchInput.style.width = '100%';\r\n                        selectWrap.appendChild(searchInput);\r\n                    }\r\n                    control = document.createElement('select');\r\n                    control.className = attrs.className || 'form-select';\r\n                    control.name = field.name;\r\n                    control.style.width = '100%';\r\n                    control.setAttribute('aria-label', field.label || field.name || '');\r\n                    const placeholderOption = document.createElement('option');\r\n                    placeholderOption.value = '';\r\n                    placeholderOption.textContent = field.placeholder ?? '\u2014';\r\n                    placeholderOption.setAttribute('aria-placeholder', 'true');\r\n                    control.appendChild(placeholderOption);\r\n                    const opts = field.options || (field.ref ? (this.baseTable.refs[field.ref] ?? null) : null);\r\n                    let populatePromise = null;\r\n                    if (opts && opts.length) {\r\n                        for (const o of opts) {\r\n                            const {\r\n                                value,\r\n                                label\r\n                            } = this.baseTable._mapOptionValueLabel(o, field);\r\n                            const optEl = document.createElement('option');\r\n                            optEl.value = value;\r\n                            optEl.textContent = label;\r\n                            optEl.title = label;\r\n                            control.appendChild(optEl);\r\n                        }\r\n                    } else {\r\n                        const tmp = document.createElement('option');\r\n                        tmp.value = '';\r\n                        tmp.disabled = true;\r\n                        tmp.selected = true;\r\n                        tmp.textContent = field.ref ? '\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...' : '\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445';\r\n                        control.appendChild(tmp);\r\n                        if (field.ref) {\r\n                            populatePromise = (async () => {\r\n                                try {\r\n                                    await this.baseTable._ensureRefLoaded(field.ref);\r\n                                } catch (e) {}\r\n                                try {\r\n                                    await this.baseTable._populateSelectFromRef(control, field);\r\n                                } catch (e) {\r\n                                    this.baseTable.error('_populateSelectFromRef async error', e);\r\n                                }\r\n                            })();\r\n                        }\r\n                    }\r\n                    control._populatePromise = populatePromise;\r\n                    if (searchInput) {\r\n                        const onSearch = (e) => {\r\n                            const q = String(e.target.value || '').toLowerCase().trim();\r\n                            Array.from(control.options).forEach(opt => {\r\n                                if (opt.getAttribute('aria-placeholder') === 'true')\r\n                                    return opt.hidden = false;\r\n                                const label = (opt.textContent || '').toLowerCase();\r\n                                opt.hidden = q ? !label.includes(q) : false;\r\n                            });\r\n                            if (control.selectedOptions.length && control.selectedOptions[0].hidden)\r\n                                control.value = '';\r\n                        };\r\n                        searchInput.addEventListener('input', onSearch);\r\n                        this.baseTable._listeners.push({\r\n                            el: searchInput,\r\n                            ev: 'input',\r\n                            fn: onSearch\r\n                        });\r\n                    }\r\n                    selectWrap.appendChild(control);\r\n                    wrap.appendChild(selectWrap);\r\n                    fieldMap[field.name] = control;\r\n                    return wrap;\r\n                }\r\n\r\n                case 'checkbox': {\r\n                    control = document.createElement('input');\r\n                    control.type = 'checkbox';\r\n                    control.className = attrs.className || 'form-check-input';\r\n                    const chkRow = document.createElement('div');\r\n                    Object.assign(chkRow.style, {\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        gap: '8px'\r\n                    });\r\n                    chkRow.appendChild(control);\r\n                    if (field.note) {\r\n                        const note = document.createElement('div');\r\n                        note.textContent = field.note;\r\n                        Object.assign(note.style, {\r\n                            fontSize: '0.92rem',\r\n                            color: '#374151'\r\n                        });\r\n                        chkRow.appendChild(note);\r\n                    }\r\n                    wrap.appendChild(chkRow);\r\n                    fieldMap[field.name] = control;\r\n                    return wrap;\r\n                }\r\n\r\n                case 'date':\r\n                    control = document.createElement('input');\r\n                    control.type = 'date';\r\n                    control.className = attrs.className || 'form-control';\r\n                    break;\r\n\r\n   case 'image': {\r\n  const row = document.createElement('div');\r\n  Object.assign(row.style, {\r\n    display: 'grid',\r\n    gridTemplateColumns: '1fr 220px',\r\n    gap: '14px',\r\n    alignItems: 'start'\r\n  });\r\n\r\n  const control = document.createElement('input');\r\n  control.type = 'hidden';\r\n  control.className = attrs.className || 'form-control';\r\n  control.name = field.name;\r\n\r\n  const dropArea = document.createElement('div');\r\n  dropArea.className = 'bt-drop';\r\n  dropArea.innerHTML = `\r\n    <div class=\"bt-drop-icon\" aria-hidden>\r\n      <svg viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M12 3v10\" stroke=\"currentColor\" stroke-width=\"1.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M8 7l4-4 4 4\" stroke=\"currentColor\" stroke-width=\"1.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M21 15v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2\" stroke=\"currentColor\" stroke-width=\"1.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>\r\n    </div>\r\n    <div class=\"bt-drop-text\">\u041F\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0438\u043B\u0438 \u043A\u043B\u0438\u043A\u043D\u0438\u0442\u0435</div>\r\n    <div class=\"bt-drop-sub\">\u041F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044E\u0442\u0441\u044F JPG, PNG, WEBP. \u041C\u0430\u043A\u0441. \u0440\u0430\u0437\u043C\u0435\u0440: 5 MB</div>\r\n  `;\r\n\r\n  const fileInput = document.createElement('input');\r\n  fileInput.type = 'file';\r\n  fileInput.accept = 'image/*';\r\n  fileInput.multiple = true;\r\n  fileInput.style.display = 'none';\r\n\r\n  const previewWrap = document.createElement('div');\r\n  previewWrap.className = 'pe-right';\r\n  const previewContainer = document.createElement('div');\r\n  previewContainer.className = 'bt-preview-list';\r\n  previewContainer.style.display = 'grid';\r\n  previewContainer.style.gap = '10px';\r\n  previewContainer.style.maxHeight = '60vh';\r\n  previewContainer.style.overflow = 'auto';\r\n  previewWrap.appendChild(previewContainer);\r\n\r\n  const controls = document.createElement('div');\r\n  controls.className = 'bt-controls';\r\n  const resetBtn = document.createElement('button');\r\n  resetBtn.type = 'button';\r\n  resetBtn.className = 'bt-btn ghost';\r\n  resetBtn.textContent = '\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C';\r\n  const openBtn = document.createElement('button');\r\n  openBtn.type = 'button';\r\n  openBtn.className = 'bt-btn primary';\r\n  openBtn.textContent = '\u041E\u0442\u043A\u0440\u044B\u0442\u044C';\r\n  controls.appendChild(resetBtn);\r\n  controls.appendChild(openBtn);\r\n  previewWrap.appendChild(controls);\r\n\r\n  const uploads = []; // records\r\n\r\n  const placeholder = (this.baseTable && typeof this.baseTable.placeholderSVG === 'function')\r\n    ? this.baseTable.placeholderSVG(360, 180)\r\n    : '';\r\n\r\n  const syncControl = () => {\r\n    const paths = uploads.filter(u => u.serverPath).map(u => u.serverPath);\r\n    try { control.value = JSON.stringify(paths); } catch (e) { control.value = '[]'; }\r\n    control.dispatchEvent(new Event('change', { bubbles: true }));\r\n  };\r\n\r\n  const makePreviewItem = (fileOrUrl, id, isExisting = false) => {\r\n    const container = document.createElement('div');\r\n    container.className = 'bt-preview-item';\r\n    Object.assign(container.style, { display: 'flex', gap: '10px', alignItems: 'center' });\r\n\r\n    const img = document.createElement('img');\r\n    img.className = 'bt-preview-thumb';\r\n    img.width = 120; img.height = 80; img.style.objectFit = 'cover';\r\n    img.alt = typeof fileOrUrl === 'string' ? (fileOrUrl.split('/').pop() || 'preview') : (fileOrUrl.name || 'preview');\r\n    img.src = placeholder;\r\n\r\n    const meta = document.createElement('div');\r\n    meta.style.flex = '1 1 auto';\r\n\r\n    const nameEl = document.createElement('div');\r\n    nameEl.className = 'bt-preview-name';\r\n    nameEl.textContent = typeof fileOrUrl === 'string' ? (fileOrUrl.split('/').pop() || '\u0424\u0430\u0439\u043B') : (fileOrUrl.name || '\u0424\u0430\u0439\u043B');\r\n\r\n    const progressWrap = document.createElement('div');\r\n    progressWrap.className = 'bt-progress-wrap small';\r\n    progressWrap.style.marginTop = '6px';\r\n    const progressBar = document.createElement('div');\r\n    progressBar.className = 'bt-progress';\r\n    const progressFill = document.createElement('div');\r\n    progressFill.className = 'bt-progress-fill';\r\n    progressFill.style.width = '0%';\r\n    progressBar.appendChild(progressFill);\r\n    const progressPercent = document.createElement('div');\r\n    progressPercent.className = 'bt-progress-percent';\r\n    progressPercent.textContent = '0%';\r\n    progressWrap.appendChild(progressBar);\r\n    progressWrap.appendChild(progressPercent);\r\n\r\n    const status = document.createElement('div');\r\n    status.className = 'bt-status bt-small';\r\n    status.textContent = isExisting ? '\u0413\u043E\u0442\u043E\u0432\u043E' : '';\r\n\r\n    meta.appendChild(nameEl);\r\n    meta.appendChild(progressWrap);\r\n    meta.appendChild(status);\r\n\r\n    const btns = document.createElement('div');\r\n    btns.style.display = 'flex';\r\n    btns.style.flexDirection = 'column';\r\n    btns.style.gap = '6px';\r\n\r\n    const btnCancel = document.createElement('button');\r\n    btnCancel.type = 'button'; btnCancel.className = 'bt-btn ghost'; btnCancel.textContent = '\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C';\r\n    const btnRetry = document.createElement('button');\r\n    btnRetry.type = 'button'; btnRetry.className = 'bt-btn primary'; btnRetry.textContent = '\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C'; btnRetry.style.display = 'none';\r\n    const btnRemove = document.createElement('button');\r\n    btnRemove.type = 'button'; btnRemove.className = 'bt-btn ghost'; btnRemove.textContent = '\u0423\u0434\u0430\u043B\u0438\u0442\u044C';\r\n\r\n    btns.appendChild(btnCancel);\r\n    btns.appendChild(btnRetry);\r\n    btns.appendChild(btnRemove);\r\n\r\n    container.appendChild(img);\r\n    container.appendChild(meta);\r\n    container.appendChild(btns);\r\n\r\n    return { container, img, progressFill, progressPercent, status, btnCancel, btnRetry, btnRemove, nameEl };\r\n  };\r\n\r\n  const uploadSingle = (file, uploadRecord) => {\r\n    return new Promise((resolve, reject) => {\r\n      if (!(file instanceof File)) return reject(new Error('uploadSingle expects File'));\r\n      if (!file.type || !file.type.startsWith('image/')) {\r\n        uploadRecord.els.status.textContent = '\u041D\u0435\u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043C\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442';\r\n        uploadRecord.els.status.classList.add('error');\r\n        uploadRecord.state = 'error';\r\n        uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n        uploadRecord.els.btnCancel.style.display = 'none';\r\n        return reject(new Error('Invalid image type'));\r\n      }\r\n\r\n      if (uploadRecord.xhr) try { uploadRecord.xhr.abort(); } catch (e) {}\r\n      const uploadUrl = (this.baseTable && this.baseTable.options && this.baseTable.options.uploadUrl) ? this.baseTable.options.uploadUrl : '/';\r\n      const categoryName = (field && field.category) || (item && item.category) || (this.baseTable && this.baseTable.options && this.baseTable.options.defaultCategory) || 'default';\r\n\r\n      const fd = new FormData();\r\n      fd.append('file', file);\r\n      fd.append('category', categoryName);\r\n      fd.append('admPanel', 'imageUpload');\r\n\r\n      const xhr = new XMLHttpRequest();\r\n      uploadRecord.xhr = xhr;\r\n      uploadRecord.state = 'uploading';\r\n      uploadRecord.els.status.textContent = '\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...';\r\n      uploadRecord.els.btnCancel.style.display = 'inline-block';\r\n      uploadRecord.els.btnRetry.style.display = 'none';\r\n      uploadRecord.els.status.classList.remove('error'); uploadRecord.els.status.classList.remove('success');\r\n\r\n      xhr.open('POST', uploadUrl, true);\r\n      if (this.baseTable && this.baseTable.options && this.baseTable.options.withCredentials) xhr.withCredentials = true;\r\n\r\n      if (this.baseTable && this.baseTable.options && this.baseTable.options.uploadHeaders) {\r\n        Object.keys(this.baseTable.options.uploadHeaders).forEach((k) => {\r\n          try { xhr.setRequestHeader(k, this.baseTable.options.uploadHeaders[k]); } catch (e) {}\r\n        });\r\n      }\r\n\r\n      const onCancel = () => {\r\n        try { xhr.abort(); } catch (e) {}\r\n        uploadRecord.els.status.textContent = '\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u043E';\r\n        uploadRecord.els.status.classList.add('error');\r\n        uploadRecord.state = 'error';\r\n        uploadRecord.els.btnCancel.style.display = 'none';\r\n        uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n        reject(new Error('Upload cancelled'));\r\n      };\r\n      uploadRecord.els.btnCancel.onclick = onCancel;\r\n\r\n      xhr.upload.onprogress = (ev) => {\r\n        if (ev.lengthComputable) {\r\n          const p = Math.round((ev.loaded / ev.total) * 100);\r\n          uploadRecord.els.progressFill.style.width = `${p}%`;\r\n          uploadRecord.els.progressPercent.textContent = `${p}%`;\r\n        } else {\r\n          uploadRecord.els.progressPercent.textContent = '...';\r\n          uploadRecord.els.progressFill.style.width = '100%';\r\n        }\r\n      };\r\n\r\n      xhr.onload = () => {\r\n        uploadRecord.xhr = null;\r\n        if (xhr.status >= 200 && xhr.status < 300) {\r\n          let data = {};\r\n          try { data = JSON.parse(xhr.responseText || '{}'); } catch (e) { data = {}; }\r\n          const serverPath = data.path || data.url || data.filePath || data.filename || data.file || null;\r\n          if (!serverPath) {\r\n            uploadRecord.els.status.textContent = '\u0421\u0435\u0440\u0432\u0435\u0440 \u043D\u0435 \u0432\u0435\u0440\u043D\u0443\u043B \u043F\u0443\u0442\u044C';\r\n            uploadRecord.els.status.classList.add('error');\r\n            uploadRecord.state = 'error';\r\n            uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n            uploadRecord.els.btnCancel.style.display = 'none';\r\n            return reject(new Error('Server did not return file path'));\r\n          }\r\n          uploadRecord.serverPath = serverPath;\r\n          uploadRecord.state = 'done';\r\n          uploadRecord.els.status.textContent = '\u0413\u043E\u0442\u043E\u0432\u043E';\r\n          uploadRecord.els.status.classList.add('success');\r\n          uploadRecord.els.btnCancel.style.display = 'none';\r\n          uploadRecord.els.btnRetry.style.display = 'none';\r\n          uploadRecord.els.img.src = serverPath;\r\n          syncControl();\r\n          resolve(serverPath);\r\n        } else {\r\n          uploadRecord.state = 'error';\r\n          uploadRecord.els.status.textContent = `\u041E\u0448\u0438\u0431\u043A\u0430 ${xhr.status}`;\r\n          uploadRecord.els.status.classList.add('error');\r\n          uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n          uploadRecord.els.btnCancel.style.display = 'none';\r\n          reject(new Error('Upload failed: ' + xhr.status));\r\n        }\r\n      };\r\n\r\n      xhr.onerror = () => {\r\n        uploadRecord.xhr = null;\r\n        uploadRecord.state = 'error';\r\n        uploadRecord.els.status.textContent = '\u0421\u0435\u0442\u0435\u0432\u0430\u044F \u043E\u0448\u0438\u0431\u043A\u0430';\r\n        uploadRecord.els.status.classList.add('error');\r\n        uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n        uploadRecord.els.btnCancel.style.display = 'none';\r\n        reject(new Error('Network error'));\r\n      };\r\n\r\n      xhr.onabort = () => {\r\n        uploadRecord.xhr = null;\r\n        uploadRecord.state = 'error';\r\n        uploadRecord.els.status.textContent = '\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u043E';\r\n        uploadRecord.els.status.classList.add('error');\r\n        uploadRecord.els.btnRetry.style.display = 'inline-block';\r\n        uploadRecord.els.btnCancel.style.display = 'none';\r\n        reject(new Error('Abort'));\r\n      };\r\n\r\n      xhr.send(fd);\r\n    });\r\n  };\r\n\r\n  const handleFiles = (fileList) => {\r\n    const files = Array.from(fileList || []);\r\n    if (!files.length) return;\r\n    files.forEach((file) => {\r\n      const id = Math.random().toString(36).slice(2);\r\n      const els = makePreviewItem(file, id, false);\r\n      previewContainer.appendChild(els.container);\r\n      const record = { id, file, xhr: null, state: 'idle', serverPath: null, els };\r\n      els.btnRetry.onclick = (e) => { e.preventDefault(); els.btnRetry.style.display = 'none'; record.state = 'idle'; uploadSingle(file, record).catch(()=>{}); };\r\n      els.btnRemove.onclick = (e) => {\r\n        e.preventDefault();\r\n        if (record.xhr) try { record.xhr.abort(); } catch (e) {}\r\n        els.container.remove();\r\n        const idx = uploads.findIndex(u => u.id === record.id);\r\n        if (idx !== -1) uploads.splice(idx, 1);\r\n        syncControl();\r\n      };\r\n      uploads.push(record);\r\n      const reader = new FileReader();\r\n      reader.onload = () => { els.img.src = String(reader.result || ''); };\r\n      reader.onerror = () => {};\r\n      reader.readAsDataURL(file);\r\n      uploadSingle(file, record).catch(() => {});\r\n    });\r\n  };\r\n\r\n  // parse initial value (try field.value first, then maybe provided 'val')\r\n  const parseInitial = (v) => {\r\n    if (v == null) return [];\r\n    if (typeof v !== 'string') return Array.isArray(v) ? v.slice() : [];\r\n    let s = v.trim();\r\n    if (!s) return [];\r\n    if (s.indexOf('&quot;') !== -1) s = s.replace(/&quot;/g, '\"').replace(/&#34;/g, '\"');\r\n    try {\r\n      const parsed = JSON.parse(s);\r\n      return Array.isArray(parsed) ? parsed.map(x => String(x)) : [];\r\n    } catch (e) {\r\n      return [s];\r\n    }\r\n  };\r\n\r\n  // initialize hidden control value from field.value or existing control attribute\r\n  const initialSource = (typeof field.value !== 'undefined') ? field.value : (attrs.value || control.value || '[]');\r\n  const initialArr = parseInitial(initialSource);\r\n  try { control.value = JSON.stringify(initialArr); } catch (e) { control.value = '[]'; }\r\n\r\n  // initialize baseTable listeners array\r\n  if (!this.baseTable) this.baseTable = this.baseTable || {};\r\n  if (!Array.isArray(this.baseTable._listeners)) this.baseTable._listeners = [];\r\n\r\n  // build upload records for existing server paths\r\n  initialArr.forEach((url) => {\r\n    const id = 'srv_' + Math.random().toString(36).slice(2);\r\n    const els = makePreviewItem(url, id, true);\r\n    // set image src to server url\r\n    els.img.src = url;\r\n    els.progressFill.style.width = '100%';\r\n    els.progressPercent.textContent = '100%';\r\n    els.status.textContent = '\u0413\u043E\u0442\u043E\u0432\u043E';\r\n    els.btnCancel.style.display = 'none';\r\n    els.btnRetry.style.display = 'none';\r\n    // remove handler\r\n    els.btnRemove.onclick = (e) => {\r\n      e.preventDefault();\r\n      const idx = uploads.findIndex(u => u.id === id);\r\n      if (idx !== -1) uploads.splice(idx, 1);\r\n      els.container.remove();\r\n      syncControl();\r\n    };\r\n    const record = { id, file: null, xhr: null, state: 'done', serverPath: url, els };\r\n    uploads.push(record);\r\n    previewContainer.appendChild(els.container);\r\n  });\r\n\r\n  // attach drag/click/paste handlers\r\n  const onClickDrop = (e) => { e.preventDefault(); fileInput.click(); };\r\n  const onFileChange = (e) => {\r\n    const fList = e.target.files ? Array.from(e.target.files) : [];\r\n    handleFiles(fList);\r\n    fileInput.value = '';\r\n  };\r\n  const onDragOver = (e) => { e.preventDefault(); dropArea.classList.add('dragging'); };\r\n  const onDragLeave = (e) => { e.preventDefault(); dropArea.classList.remove('dragging'); };\r\n  const onDrop = (e) => {\r\n    e.preventDefault();\r\n    dropArea.classList.remove('dragging');\r\n    const dtFiles = (e.dataTransfer && e.dataTransfer.files) ? Array.from(e.dataTransfer.files) : [];\r\n    if (dtFiles.length) { handleFiles(dtFiles); return; }\r\n    const text = (e.dataTransfer && e.dataTransfer.getData && e.dataTransfer.getData('text')) || '';\r\n    if (text && text.startsWith('http')) {\r\n      // add URL as serverPath (no upload)\r\n      const id = 'url_' + Math.random().toString(36).slice(2);\r\n      const els = makePreviewItem(text, id, true);\r\n      els.img.src = text;\r\n      els.btnRemove.onclick = (ev) => { ev.preventDefault(); const idx = uploads.findIndex(u => u.id === id); if (idx !== -1) uploads.splice(idx, 1); els.container.remove(); syncControl(); };\r\n      const record = { id, file: null, xhr: null, state: 'done', serverPath: text, els };\r\n      uploads.push(record);\r\n      previewContainer.appendChild(els.container);\r\n      syncControl();\r\n    }\r\n  };\r\n  const onPaste = (e) => {\r\n    const items = (e.clipboardData && e.clipboardData.items) || [];\r\n    const collected = [];\r\n    for (let i = 0; i < items.length; i++) {\r\n      const it = items[i];\r\n      if (it.kind === 'file') {\r\n        const f = it.getAsFile();\r\n        if (f) collected.push(f);\r\n      }\r\n    }\r\n    if (collected.length) handleFiles(collected);\r\n    else {\r\n      const text = (e.clipboardData || window.clipboardData).getData('text');\r\n      if (text && text.startsWith('http')) {\r\n        // add url as serverPath\r\n        const id = 'url_' + Math.random().toString(36).slice(2);\r\n        const els = makePreviewItem(text, id, true);\r\n        els.img.src = text;\r\n        els.btnRemove.onclick = (ev) => { ev.preventDefault(); const idx = uploads.findIndex(u => u.id === id); if (idx !== -1) uploads.splice(idx, 1); els.container.remove(); syncControl(); };\r\n        const record = { id, file: null, xhr: null, state: 'done', serverPath: text, els };\r\n        uploads.push(record);\r\n        previewContainer.appendChild(els.container);\r\n        syncControl();\r\n      }\r\n    }\r\n  };\r\n\r\n  // reset/open\r\n  const onReset = (e) => {\r\n    e.preventDefault();\r\n    uploads.forEach(u => { try { u.xhr && u.xhr.abort(); } catch (e) {} });\r\n    uploads.length = 0;\r\n    previewContainer.innerHTML = '';\r\n    control.value = '[]';\r\n    control.dispatchEvent(new Event('change', { bubbles: true }));\r\n  };\r\n  const onOpen = (e) => {\r\n    e.preventDefault();\r\n    let arr;\r\n    try { arr = JSON.parse(control.value || '[]'); } catch (e) { arr = []; }\r\n    if (arr.length) window.open(arr[0], '_blank');\r\n    else if (typeof showToast === 'function') showToast('\u041D\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043D\u044B\u0445 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0439');\r\n  };\r\n\r\n  // wire listeners and record for cleanup\r\n  dropArea.addEventListener('click', onClickDrop);\r\n  this.baseTable._listeners.push({ el: dropArea, ev: 'click', fn: onClickDrop });\r\n\r\n  fileInput.addEventListener('change', onFileChange);\r\n  this.baseTable._listeners.push({ el: fileInput, ev: 'change', fn: onFileChange });\r\n\r\n  dropArea.addEventListener('dragover', onDragOver);\r\n  this.baseTable._listeners.push({ el: dropArea, ev: 'dragover', fn: onDragOver });\r\n  dropArea.addEventListener('dragleave', onDragLeave);\r\n  this.baseTable._listeners.push({ el: dropArea, ev: 'dragleave', fn: onDragLeave });\r\n  dropArea.addEventListener('drop', onDrop);\r\n  this.baseTable._listeners.push({ el: dropArea, ev: 'drop', fn: onDrop });\r\n\r\n  document.addEventListener('paste', onPaste);\r\n  this.baseTable._listeners.push({ el: document, ev: 'paste', fn: onPaste });\r\n\r\n  resetBtn.addEventListener('click', onReset);\r\n  this.baseTable._listeners.push({ el: resetBtn, ev: 'click', fn: onReset });\r\n\r\n  openBtn.addEventListener('click', onOpen);\r\n  this.baseTable._listeners.push({ el: openBtn, ev: 'click', fn: onOpen });\r\n\r\n  // assemble DOM\r\n  const leftCol = document.createElement('div');\r\n  leftCol.appendChild(dropArea);\r\n  leftCol.appendChild(fileInput);\r\n  leftCol.appendChild(control);\r\n\r\n  row.appendChild(leftCol);\r\n  row.appendChild(previewWrap);\r\n  wrap.appendChild(row);\r\n\r\n  fieldMap[field.name] = control;\r\n\r\n  // make sure control reflects current serverPaths (synchronize)\r\n  syncControl();\r\n\r\n  return wrap;\r\n}\r\n\r\n\r\n\r\n                case 'hidden':\r\n                    control = document.createElement('input');\r\n                    control.type = 'hidden';\r\n                    break;\r\n\t\t\t\t\t\r\n\t\t\t\t//TEST\t\r\n\t\t\t\tcase 'froala': {\r\n\t\t\t\t\t// \u0441\u043E\u0437\u0434\u0430\u0451\u043C textarea\r\n\t\t\t\t\tconsole.log('FROALA');\r\n\t\t\t\t\tcontrol = document.createElement('textarea');\r\n\r\n\t\t\t\t\t// \u0434\u0430\u0451\u043C id, \u0435\u0441\u043B\u0438 \u0435\u0433\u043E \u043D\u0435\u0442 (\u043D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0431\u0438\u0431\u043B\u0438\u043E\u0442\u0435\u043A\u0438 \u043E\u0436\u0438\u0434\u0430\u044E\u0442 \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u0439 id)\r\n\t\t\t\t\tif (!field.id) {\r\n\t\t\t\t\t\tfield.id = 'froala-' + Math.random().toString(36).slice(2, 9);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontrol.id = field.id;\r\n\r\n\t\t\t\t\tcontrol.className = attrs.className || 'form-control froala-textarea';\r\n\t\t\t\t\tif (field.placeholder) control.placeholder = field.placeholder;\r\n\t\t\t\t\tif (field.value) control.value = field.value;\r\n\t\t\t\t\tcontrol.dataset.editorType = 'froala';\r\n\r\n\t\t\t\t\t// \u0418\u041D\u0421\u0422\u0420\u0423\u041A\u0426\u0418\u042F: \u0432\u044B\u0437\u044B\u0432\u0430\u0439\u0442\u0435 control._initFroala() \u0442\u043E\u043B\u044C\u043A\u043E \u043F\u043E\u0441\u043B\u0435 appendChild(control)\r\n\r\n\t\t\t\t\tcontrol._initFroala = function (froalaOptions = {}) {\r\n\t\t\t\t\t\tconsole.log('-> _initFroala called for', control.id);\r\n\r\n\t\t\t\t\t\tif (control._froalaEditor) {\r\n\t\t\t\t\t\t\tconsole.log('Froala already initialized for', control.id);\r\n\t\t\t\t\t\t\treturn control._froalaEditor;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (typeof FroalaEditor === 'undefined') {\r\n\t\t\t\t\t\t\tconsole.warn('FroalaEditor is not loaded. Include Froala JS/CSS before initializing.');\r\n\t\t\t\t\t\t\treturn null; // \u043F\u0440\u0435\u0440\u044B\u0432\u0430\u0435\u043C \u2014 \u0438\u043D\u0430\u0447\u0435 new FroalaEditor \u0443\u043F\u0430\u0434\u0451\u0442\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst defaultOpts = {\r\n\t\t\t\t\t\t\ttoolbarButtons: froalaOptions.toolbarButtons || [\r\n\t\t\t\t\t\t\t\t'bold', 'italic', 'underline', '|', 'formatUL', 'formatOL', '|', 'insertLink', 'insertImage', 'undo', 'redo'\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\tplaceholderText: field.placeholder || '',\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst opts = Object.assign({}, defaultOpts, froalaOptions);\r\n\r\n\t\t\t\t\t\t// \u041F\u0435\u0440\u0435\u0434\u0430\u0451\u043C DOM-\u044D\u043B\u0435\u043C\u0435\u043D\u0442 \u043D\u0430\u043F\u0440\u044F\u043C\u0443\u044E \u2014 \u043D\u0430\u0434\u0451\u0436\u043D\u0435\u0435, \u0447\u0435\u043C \u0441\u0435\u043B\u0435\u043A\u0442\u043E\u0440\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcontrol._froalaEditor = new FroalaEditor(control, opts, function () {\r\n\t\t\t\t\t\t\t\tconsole.log('Froala editor initialized callback for', control.id);\r\n\t\t\t\t\t\t\t\tif (field.value) {\r\n\t\t\t\t\t\t\t\t\ttry { control._froalaEditor.html.set(field.value); } catch (e) { control.value = field.value; }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (field.readOnly || field.disabled) {\r\n\t\t\t\t\t\t\t\t\ttry { control._froalaEditor.edit.off(); }\r\n\t\t\t\t\t\t\t\t\tcatch (e) { control._froalaEditor.opts.toolbarButtons = []; }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\tconsole.error('\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438 Froala: ', err);\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// \u041F\u043E\u0434\u043F\u0438\u0441\u043A\u0430 \u043D\u0430 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcontrol._froalaEditor.events.on('contentChanged', function () {\r\n\t\t\t\t\t\t\t\ttry { control.value = control._froalaEditor.html.get(); } catch (e) {}\r\n\t\t\t\t\t\t\t\tcontrol.dispatchEvent(new Event('input', { bubbles: true }));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t// \u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0432\u0435\u0440\u0441\u0438\u0438/\u0441\u0431\u043E\u0440\u043A\u0438 Froala \u043C\u043E\u0433\u0443\u0442 \u0438\u043C\u0435\u0442\u044C \u0434\u0440\u0443\u0433\u043E\u0439 API \u2014 \u043B\u043E\u0433\u0438\u0440\u0443\u0435\u043C\r\n\t\t\t\t\t\t\tconsole.warn('\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F \u043D\u0430 contentChanged:', e);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn control._froalaEditor;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcontrol.getHtml = function () {\r\n\t\t\t\t\t\tif (control._froalaEditor) {\r\n\t\t\t\t\t\t\ttry { return control._froalaEditor.html.get(); } catch (e) { return control.value; }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn control.value;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcontrol._destroyFroala = function () {\r\n\t\t\t\t\t\tif (control._froalaEditor) {\r\n\t\t\t\t\t\t\ttry { control._froalaEditor.destroy(); } catch (e) { console.warn(e); }\r\n\t\t\t\t\t\t\tcontrol._froalaEditor = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\r\n\r\n                case 'json': {\r\n                    // editable JSON key:value editor (list + add/remove) + hidden field for submission\r\n                    const rowWrap = document.createElement('div');\r\n                    rowWrap.className = attrs.className || 'bt-wrap';\r\n                    Object.assign(rowWrap.style, {\r\n                        marginTop: '6px'\r\n                    });\r\n\r\n                    // container for list of pairs\r\n                    const list = document.createElement('ul');\r\n                    list.className = 'bt-json-list';\r\n                    Object.assign(list.style, {\r\n                        margin: '6px 0 0 0',\r\n                        paddingLeft: '18px'\r\n                    });\r\n\r\n                    // hidden textarea (so form submits the JSON string) - we'll also parse it on submit to get an object\r\n                    const hidden = document.createElement('textarea');\r\n                    hidden.name = field.name;\r\n                    hidden.style.display = 'none';\r\n\r\n                    // helper: parse incoming data (string or object) into plain object\r\n                    let initialObj = {};\r\n                    const raw = (item && item[field.name] !== undefined) ? item[field.name] : (field.value ?? {});\r\n                    try {\r\n                        initialObj = (typeof raw === 'string') ? JSON.parse(raw) : (raw && typeof raw === 'object' ? raw : {});\r\n                    } catch (e) {\r\n                        initialObj = {};\r\n                    }\r\n\r\n                    // create controls area (Add button)\r\n                    const controls = document.createElement('div');\r\n                    controls.className = 'bt-json-controls';\r\n                    Object.assign(controls.style, {\r\n                        marginTop: '8px',\r\n                        display: 'flex',\r\n                        gap: '8px'\r\n                    });\r\n\r\n                    const addBtn = document.createElement('button');\r\n                    addBtn.type = 'button';\r\n                    addBtn.className = 'btn btn-sm btn-outline-secondary';\r\n                    addBtn.textContent = field.addLabel || '\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0430\u0440\u0443';\r\n\r\n                    controls.appendChild(addBtn);\r\n\r\n                    // internal helper to sync hidden value from current list\r\n                    const updateHidden = () => {\r\n                        const obj = {};\r\n                        Array.from(list.children).forEach(li => {\r\n                            const kInput = li.querySelector('.bt-json-key');\r\n                            const vInput = li.querySelector('.bt-json-value');\r\n                            if (!kInput)\r\n                                return;\r\n                            const key = String(kInput.value || '').trim();\r\n                            if (!key)\r\n                                return;\r\n                            // skip empty keys\r\n                            // store value as string - leave type parsing for submitHandler if needed\r\n                            obj[key] = (vInput ? vInput.value : '');\r\n                        });\r\n                        try {\r\n                            hidden.value = JSON.stringify(obj);\r\n                        } catch (e) {\r\n                            hidden.value = '{}';\r\n                        }\r\n                    };\r\n\r\n                    // create a row (li) with key/value inputs and remove button\r\n                    const makeRow = (key = '', value = '') => {\r\n                        const li = document.createElement('li');\r\n                        Object.assign(li.style, {\r\n                            marginBottom: '6px',\r\n                            display: 'flex',\r\n                            gap: '8px',\r\n                            alignItems: 'center'\r\n                        });\r\n\r\n                        const keyInput = document.createElement('input');\r\n                        keyInput.type = 'text';\r\n                        keyInput.placeholder = '\u043A\u043B\u044E\u0447';\r\n                        keyInput.className = 'bt-json-key form-control form-control-sm';\r\n                        keyInput.value = key;\r\n\r\n                        const valInput = document.createElement('input');\r\n                        valInput.type = 'text';\r\n                        valInput.placeholder = '\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435';\r\n                        valInput.className = 'bt-json-value form-control form-control-sm';\r\n                        valInput.value = (value === null || value === undefined) ? '' : String(value);\r\n\r\n                        const removeBtn = document.createElement('button');\r\n                        removeBtn.type = 'button';\r\n                        removeBtn.className = 'btn btn-sm btn-outline-danger';\r\n                        removeBtn.textContent = '\u2715';\r\n                        removeBtn.title = '\u0423\u0434\u0430\u043B\u0438\u0442\u044C';\r\n\r\n                        // append inputs\r\n                        // make key narrower\r\n                        Object.assign(keyInput.style, {\r\n                            width: '30%'\r\n                        });\r\n                        Object.assign(valInput.style, {\r\n                            width: 'calc(70% - 34px)'\r\n                        });\r\n                        // leave space for remove button\r\n                        Object.assign(removeBtn.style, {\r\n                            flex: '0 0 34px',\r\n                            height: '30px',\r\n                            padding: '0 6px'\r\n                        });\r\n\r\n                        li.appendChild(keyInput);\r\n                        li.appendChild(valInput);\r\n                        li.appendChild(removeBtn);\r\n\r\n                        // wire events: update hidden on input\r\n                        const onInput = () => updateHidden();\r\n                        keyInput.addEventListener('input', onInput);\r\n                        valInput.addEventListener('input', onInput);\r\n                        this.baseTable._listeners.push({\r\n                            el: keyInput,\r\n                            ev: 'input',\r\n                            fn: onInput\r\n                        });\r\n                        this.baseTable._listeners.push({\r\n                            el: valInput,\r\n                            ev: 'input',\r\n                            fn: onInput\r\n                        });\r\n\r\n                        const onRemove = (ev) => {\r\n                            ev.preventDefault();\r\n                            // remove li and update hidden\r\n                            try {\r\n                                li.remove();\r\n                            } catch (e) {\r\n                                li.parentNode && li.parentNode.removeChild(li);\r\n                            }\r\n                            updateHidden();\r\n                        };\r\n                        removeBtn.addEventListener('click', onRemove);\r\n                        this.baseTable._listeners.push({\r\n                            el: removeBtn,\r\n                            ev: 'click',\r\n                            fn: onRemove\r\n                        });\r\n\r\n                        return li;\r\n                    };\r\n\r\n                    // populate initial rows\r\n                    if (initialObj && typeof initialObj === 'object') {\r\n                        if (Array.isArray(initialObj)) {\r\n                            initialObj.forEach((v, i) => list.appendChild(makeRow(String(i), (typeof v === 'object') ? JSON.stringify(v) : String(v))));\r\n                        } else {\r\n                            Object.entries(initialObj).forEach(([k, v]) => list.appendChild(makeRow(k, (typeof v === 'object') ? JSON.stringify(v) : String(v))));\r\n                        }\r\n                    }\r\n\r\n                    // initial sync\r\n                    updateHidden();\r\n\r\n                    // add button behavior\r\n                    const onAdd = (ev) => {\r\n                        ev.preventDefault();\r\n                        const newLi = makeRow('', '');\r\n                        list.appendChild(newLi);\r\n                        // focus to key input of the new row\r\n                        const keyInp = newLi.querySelector('.bt-json-key');\r\n                        if (keyInp)\r\n                            setTimeout(() => {\r\n                                try {\r\n                                    keyInp.focus();\r\n                                } catch (e) {}\r\n                            }, 10);\r\n                        updateHidden();\r\n                    };\r\n                    addBtn.addEventListener('click', onAdd);\r\n                    this.baseTable._listeners.push({\r\n                        el: addBtn,\r\n                        ev: 'click',\r\n                        fn: onAdd\r\n                    });\r\n\r\n                    // assemble\r\n                    rowWrap.appendChild(list);\r\n                    rowWrap.appendChild(controls);\r\n                    rowWrap.appendChild(hidden);\r\n\r\n                    wrap.appendChild(rowWrap);\r\n\r\n                    // expose the hidden field to fieldMap so _buildFormFromSchema can set its value if needed\r\n                    fieldMap[field.name] = hidden;\r\n                    return wrap;\r\n                }\r\n\r\n                case 'link':\r\n                case 'text':\r\n                default:\r\n                    control = document.createElement('input');\r\n                    control.type = 'text';\r\n                    control.className = attrs.className || 'form-control';\r\n                    if (field.placeholder)\r\n                        control.placeholder = field.placeholder;\r\n                    break;\r\n            }\r\n\r\n            if (!control)\r\n                control = document.createElement('input');\r\n\r\n            control.name = field.name;\r\n            control.id = `bt-field-${field.name}`;\r\n            control.setAttribute('aria-label', field.label || field.name || '');\r\n            if (field.required)\r\n                control.required = true;\r\n            if (field.readonly)\r\n                control.readOnly = true;\r\n            if (field.disabled)\r\n                control.disabled = true;\r\n\r\n            if (field.note) {\r\n                const note = document.createElement('div');\r\n                note.className = 'pe-note';\r\n                note.textContent = field.note;\r\n                Object.assign(note.style, {\r\n                    fontSize: '0.86rem',\r\n                    color: '#6b7280'\r\n                });\r\n                wrap.appendChild(control);\r\n                wrap.appendChild(note);\r\n            } else\r\n                wrap.appendChild(control);\r\n\r\n            const errorHint = document.createElement('div');\r\n            errorHint.className = 'bt-field-error';\r\n            Object.assign(errorHint.style, {\r\n                color: '#ef4444',\r\n                fontSize: '0.82rem',\r\n                display: 'none'\r\n            });\r\n            wrap.appendChild(errorHint);\r\n\r\n            const onInvalid = (e) => {\r\n                e.preventDefault();\r\n                errorHint.textContent = field.errorMessage || '\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E';\r\n                errorHint.style.display = 'block';\r\n            };\r\n            control.addEventListener('invalid', onInvalid);\r\n            this.baseTable._listeners.push({\r\n                el: control,\r\n                ev: 'invalid',\r\n                fn: onInvalid\r\n            });\r\n\r\n            const onInputHide = () => {\r\n                errorHint.style.display = 'none';\r\n            };\r\n            control.addEventListener('input', onInputHide);\r\n            this.baseTable._listeners.push({\r\n                el: control,\r\n                ev: 'input',\r\n                fn: onInputHide\r\n            });\r\n\r\n            fieldMap[field.name] = control;\r\n            return wrap;\r\n        };\r\n\r\n        const groupNames = Object.keys(groups);\r\n        for (const gName of groupNames) {\r\n            const fields = groups[gName];\r\n            const isDefault = (gName === '__default');\r\n            if (!isDefault) {\r\n                const card = makeFieldCard(gName);\r\n                card.style.gridColumn = '1 / -1';\r\n                const title = document.createElement('div');\r\n                Object.assign(title.style, {\r\n                    fontWeight: 700,\r\n                    marginBottom: '8px'\r\n                });\r\n                title.textContent = gName;\r\n                card.appendChild(title);\r\n                const inner = document.createElement('div');\r\n                Object.assign(inner.style, {\r\n                    display: 'grid',\r\n                    gridTemplateColumns: '1fr 1fr',\r\n                    gap: '12px'\r\n                });\r\n                for (const f of fields) {\r\n                    const node = makeRow(f);\r\n                    inner.appendChild(node);\r\n                }\r\n                card.appendChild(inner);\r\n                grid.appendChild(card);\r\n            } else {\r\n                for (const f of fields) {\r\n                    const node = makeRow(f);\r\n                    if (f.layout === 'full')\r\n                        node.style.gridColumn = '1 / -1';\r\n                    grid.appendChild(node);\r\n                }\r\n            }\r\n        }\r\n\r\n        const actionsWrap = document.createElement('div');\r\n        Object.assign(actionsWrap.style, {\r\n            gridColumn: '1 / -1',\r\n            display: 'flex',\r\n            justifyContent: 'flex-end',\r\n            gap: '10px',\r\n            paddingTop: '6px'\r\n        });\r\n\r\n        const submit = document.createElement('button');\r\n        submit.type = 'submit';\r\n        submit.className = 'btn btn-primary';\r\n        submit.textContent = '\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C';\r\n\r\n        const cancel = document.createElement('button');\r\n        cancel.type = 'button';\r\n        cancel.className = 'btn btn-outline-secondary';\r\n        cancel.textContent = '\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C';\r\n        cancel.dataset.action = 'cancel';\r\n\r\n        actionsWrap.appendChild(submit);\r\n        actionsWrap.appendChild(cancel);\r\n\r\n        form.appendChild(grid);\r\n        grid.appendChild(actionsWrap);\r\n\r\n        for (const f of this.baseTable.formSchema) {\r\n            const el = fieldMap[f.name];\r\n            if (!el)\r\n                continue;\r\n            const val = item[f.name];\r\n\r\n            switch (f.type) {\r\n                case 'checkbox':\r\n                    el.checked = Boolean(val);\r\n                    break;\r\n\r\n                case 'date':\r\n                    if (val)\r\n                        el.value = val;\r\n                    break;\r\n\r\n                case 'select':\r\n                    if (val !== undefined && val !== null && String(val) !== '') {\r\n                        try {\r\n                            el.value = String(val);\r\n                        } catch (e) {}\r\n                        const hasOption = Array.from(el.options).some(o => o.value === String(val));\r\n                        if (!hasOption && f.ref) {\r\n                            (async () => {\r\n                                try {\r\n                                    if (el._populatePromise)\r\n                                        await el._populatePromise;\r\n                                    else\r\n                                        await this.baseTable._ensureRefLoaded(f.ref).catch(() => {});\r\n                                    await this.baseTable._populateSelectFromRef(el, f);\r\n                                } catch (e) {\r\n                                    this.baseTable.error('async select populate/set error', e);\r\n                                }\r\n                                try {\r\n                                    el.value = String(val);\r\n                                } catch (e) {}\r\n                                if (!Array.from(el.options).some(o => o.value === String(val))) {\r\n                                    setTimeout(() => {\r\n                                        try {\r\n                                            el.value = String(val);\r\n                                        } catch (e) {}\r\n                                    }, 60);\r\n                                }\r\n                            })();\r\n                        }\r\n                    }\r\n                    break;\r\n\r\ncase 'image': {\r\n  try {\r\n    const ctrlEl = (el.id && form.querySelector(`#${el.id}`)) ? form.querySelector(`#${el.id}`) : el;\r\n    const rowEl = ctrlEl ? (ctrlEl.closest?.('.bt-form-row') || ctrlEl.parentNode) : null;\r\n    const fileInput = rowEl ? rowEl.querySelector('input[type=\"file\"]') : null;\r\n    let preview = rowEl ? rowEl.querySelector('img.bt-image-preview') : null;\r\n    let thumbsWrap = rowEl ? rowEl.querySelector('.bt-wrap') : null;\r\n\r\n    const parseImages = (v) => {\r\n      if (v == null) return [];\r\n      if (typeof v === 'string') {\r\n        const s = v.trim();\r\n        if (!s) return [];\r\n        try { const p = JSON.parse(s); return parseImages(p); } catch (e) { return [s]; }\r\n      }\r\n      if (Array.isArray(v)) {\r\n        return v.map(x => (typeof x === 'string' ? x : String(x))).filter(Boolean);\r\n      }\r\n      if (typeof v === 'object' && v !== null) {\r\n        const keys = ['src','url','path','file','location','image','thumb','thumbnail'];\r\n        for (const k of keys) {\r\n          if (v[k]) {\r\n            const found = parseImages(v[k]);\r\n            if (found.length) return found;\r\n          }\r\n        }\r\n        const numeric = Object.keys(v).filter(k => String(Number(k)) === k)\r\n          .sort((a,b)=>Number(a)-Number(b)).map(k => v[k]);\r\n        if (numeric.length) return parseImages(numeric);\r\n      }\r\n      return [];\r\n    };\r\n\r\n    let currentArr = parseImages(val ?? el.value);\r\n\r\n    const placeholder = (this.baseTable && typeof this.baseTable.placeholderSVG === 'function')\r\n      ? this.baseTable.placeholderSVG(320, 180)\r\n      : (this.options && this.options.placeholder) || '';\r\n\r\n    const saveHidden = (arr) => {\r\n      try { el.value = JSON.stringify(arr); } catch (e) { el.value = JSON.stringify([]); }\r\n    };\r\n    saveHidden(currentArr);\r\n\r\n    if (!preview && rowEl) {\r\n      preview = document.createElement('img');\r\n      preview.className = 'bt-image-preview';\r\n      preview.alt = 'preview';\r\n      preview.src = currentArr.length ? currentArr[0] : placeholder;\r\n      rowEl.insertBefore(preview, rowEl.firstChild);\r\n    } else if (preview) {\r\n      preview.src = currentArr.length ? currentArr[0] : placeholder;\r\n    }\r\n\r\n    if (!thumbsWrap && rowEl) {\r\n      thumbsWrap = document.createElement('div');\r\n      thumbsWrap.className = 'bt-wrap';\r\n      rowEl.appendChild(thumbsWrap);\r\n    }\r\n\r\n    const renderThumbnails = (arr) => {\r\n      if (!thumbsWrap) return;\r\n      thumbsWrap.innerHTML = '';\r\n      arr.forEach((src, idx) => {\r\n        const wrap = document.createElement('div');\r\n        wrap.className = 'bt-thumb';\r\n        wrap.dataset.index = idx;\r\n\r\n        const img = document.createElement('img');\r\n        img.className = 'bt-thumb-img';\r\n        img.src = src || placeholder;\r\n        img.alt = `img-${idx}`;\r\n        img.loading = 'lazy';\r\n        img.dataset.index = idx;\r\n\r\n        const btn = document.createElement('button');\r\n        btn.type = 'button';\r\n        btn.className = 'bt-thumb-remove';\r\n        btn.innerText = '\u00D7';\r\n        btn.title = '\u0423\u0434\u0430\u043B\u0438\u0442\u044C';\r\n        btn.dataset.index = idx;\r\n\r\n        wrap.appendChild(img);\r\n        wrap.appendChild(btn);\r\n        thumbsWrap.appendChild(wrap);\r\n      });\r\n    };\r\n\r\n    renderThumbnails(currentArr);\r\n\r\n    if (!this.baseTable) this.baseTable = this.baseTable || {};\r\n    if (!Array.isArray(this.baseTable._listeners)) this.baseTable._listeners = this.baseTable._listeners || [];\r\n\r\n    const refreshState = (arr) => {\r\n      currentArr = Array.isArray(arr) ? arr.slice() : parseImages(el.value);\r\n      saveHidden(currentArr);\r\n      if (preview) preview.src = currentArr.length ? currentArr[0] : placeholder;\r\n      renderThumbnails(currentArr);\r\n    };\r\n\r\n    if (fileInput) {\r\n      const onFileChange = (e) => {\r\n        const f = e.target.files && e.target.files[0];\r\n        if (!f) return;\r\n        if (!f.type || !f.type.startsWith('image/')) return;\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n          const dataUrl = String(reader.result || '');\r\n          let arr;\r\n          try { arr = parseImages(el.value); } catch (err) { arr = []; }\r\n          arr.unshift(dataUrl);\r\n          refreshState(arr);\r\n        };\r\n        reader.onerror = () => { if (preview) preview.src = placeholder; };\r\n        reader.readAsDataURL(f);\r\n      };\r\n\r\n      const already = (this.baseTable._listeners || []).some(l => l.el === fileInput && l.ev === 'change' && l.fn === onFileChange);\r\n      if (!already) {\r\n        fileInput.addEventListener('change', onFileChange);\r\n        this.baseTable._listeners.push({ el: fileInput, ev: 'change', fn: onFileChange });\r\n      }\r\n    }\r\n\r\n    if (thumbsWrap) {\r\n\t\tthis.addNotice(thumbsWrap, {\r\n\t\t  type: 'info',\r\n\t\t  title: '\u0417\u0430\u043C\u0435\u0442\u043A\u0430',\r\n\t\t  description: '\u041F\u0440\u0438 \u043D\u0430\u0436\u0430\u0442\u0438\u0438 \u043D\u0430 \u043C\u0438\u043D\u0438\u0430\u0442\u044E\u0440\u0443 \u043E\u043D\u0430 \u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u0441\u044F \u0433\u043B\u0430\u0432\u043D\u044B\u043C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435\u043C \u0442\u043E\u0432\u0430\u0440\u0430!',\r\n\t\t  timeout: 5000\r\n\t\t});\r\n      const onThumbClick = (ev) => {\r\n        const target = ev.target;\r\n\r\n        if (target.matches('.bt-thumb-remove')) {\r\n          const idx = Number(target.dataset.index);\r\n          if (!Number.isNaN(idx)) {\r\n            const arr = parseImages(el.value);\r\n            arr.splice(idx, 1);\r\n            refreshState(arr);\r\n          }\r\n          ev.stopPropagation();\r\n          return;\r\n        }\r\n\r\n        const thumbEl = target.closest?.('.bt-thumb');\r\n        if (!thumbEl) return;\r\n        const img = thumbEl.querySelector('img.bt-thumb-img');\r\n        if (!img) return;\r\n        const idx = Number(img.dataset.index);\r\n        if (Number.isNaN(idx)) return;\r\n\r\n        const arr = parseImages(el.value);\r\n        if (!arr[idx]) return;\r\n\r\n        // \u043F\u0435\u0440\u0435\u043C\u0435\u0449\u0430\u0435\u043C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0439 \u044D\u043B\u0435\u043C\u0435\u043D\u0442 \u0432 \u043D\u0430\u0447\u0430\u043B\u043E \u043C\u0430\u0441\u0441\u0438\u0432\u0430\r\n        const [item] = arr.splice(idx, 1);\r\n        arr.unshift(item);\r\n        refreshState(arr);\r\n\r\n        ev.stopPropagation();\r\n      };\r\n\r\n      const alreadyThumb = (this.baseTable._listeners || []).some(l => l.el === thumbsWrap && l.ev === 'click' && l.fn === onThumbClick);\r\n      if (!alreadyThumb) {\r\n        thumbsWrap.addEventListener('click', onThumbClick);\r\n        this.baseTable._listeners.push({ el: thumbsWrap, ev: 'click', fn: onThumbClick });\r\n      }\r\n    }\r\n\r\n  } catch (err) {\r\n    if (this.baseTable && typeof this.baseTable.error === 'function') this.baseTable.error('image init error', err);\r\n    else console.error('image init error', err);\r\n  }\r\n  break;\r\n}\r\n\r\n\r\n                case 'price':\r\n                    if (val !== undefined && val !== null && String(val) !== '') {\r\n                        try {\r\n                            el.value = String(val);\r\n                        } catch (e) {}\r\n                    }\r\n                    try {\r\n                        this.baseTable._applyPriceMaskToElement(el, val);\r\n                    } catch (e) {\r\n                        this.baseTable.error('_applyPriceMaskToElement error', e);\r\n                    }\r\n                    break;\r\n\r\n                default:\r\n                    if (val !== undefined && val !== null) {\r\n                        try {\r\n                            el.value = String(val);\r\n                        } catch (e) {}\r\n                    }\r\n            }\r\n\r\n            // If field is price but was not covered in switch (safety), ensure mask applied:\r\n            if (f.type !== 'price' && el && el.matches && el.matches('input.bt-field-price')) {\r\n                try {\r\n                    this.baseTable._applyPriceMaskToElement(el, el.value || null);\r\n                } catch (e) {}\r\n            }\r\n        }\r\n\r\n        return {\r\n            form,\r\n            fieldMap,\r\n            submitBtn: submit,\r\n            cancelBtn: cancel\r\n        };\r\n    }\r\n\t\r\n/**\r\n * \u0414\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u0442 notice \u0432 \u043A\u043E\u043D\u0442\u0435\u0439\u043D\u0435\u0440 (.notice-window \u0438\u043B\u0438 .notice-stack).\r\n *\r\n * container - Element (\u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 .notice-window \u0438\u043B\u0438 \u044D\u043B\u0435\u043C\u0435\u043D\u0442 .notice-stack \u0432\u043D\u0443\u0442\u0440\u0438 \u043D\u0435\u0433\u043E)\r\n * options:\r\n *  - type: 'info'|'success'|'warning'|'danger'\r\n *  - title: string\r\n *  - description: string\r\n *  - timeout: ms (0 \u2014 \u043D\u0435 \u0430\u0432\u0442\u043E\u0441\u043A\u0440\u044B\u0432\u0430\u0442\u044C)\r\n *  - icon: optional FontAwesome \u043A\u043B\u0430\u0441\u0441 (\u0441\u0442\u0440\u043E\u043A\u0430)\r\n *  - appendToTop: boolean (true \u2014 \u0432\u0441\u0442\u0430\u0432\u043B\u044F\u0442\u044C \u0432 \u043D\u0430\u0447\u0430\u043B\u043E \u0441\u0442\u0435\u043A\u0430)\r\n *  - closeLabel: string (aria-label \u0434\u043B\u044F \u043A\u043D\u043E\u043F\u043A\u0438 \u0437\u0430\u043A\u0440\u044B\u0442\u0438\u044F)\r\n *  - onClose: function(reason) optional callback ('manual'|'timeout'|'esc'|'removed')\r\n *  - autofocus: boolean (\u0444\u043E\u043A\u0443\u0441 \u043D\u0430 \u0443\u0432\u0435\u0434\u043E\u043C\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0441\u043B\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F)\r\n */\r\naddNotice(container, {\r\n  type = 'info',\r\n  title = '',\r\n  description = '',\r\n  timeout = 4000,\r\n  icon = '',\r\n  appendToTop = false,\r\n  closeLabel = '\u0417\u0430\u043A\u0440\u044B\u0442\u044C \u0443\u0432\u0435\u0434\u043E\u043C\u043B\u0435\u043D\u0438\u0435',\r\n  onClose = null,\r\n  autofocus = false\r\n} = {}) {\r\n  if (!container || !(container instanceof Element)) return null;\r\n\r\n  const icons = {\r\n    info: 'fa-solid fa-circle-info',\r\n    success: 'fa-solid fa-check-circle',\r\n    warning: 'fa-solid fa-triangle-exclamation',\r\n    danger: 'fa-solid fa-xmark-circle'\r\n  };\r\n  const chosenIcon = (typeof icon === 'string' && icon.trim()) ? icon.trim() : (icons[type] || icons.info);\r\n\r\n  // \u043D\u0430\u0439\u0434\u0435\u043C \u0441\u0442\u0435\u043A \u0432\u043D\u0443\u0442\u0440\u0438 \u043A\u043E\u043D\u0442\u0435\u0439\u043D\u0435\u0440\u0430 (\u0435\u0441\u043B\u0438 \u0435\u0441\u0442\u044C), \u0438\u043D\u0430\u0447\u0435 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u0441\u0430\u043C container\r\n  const stack = container.querySelector('.notice-stack') || container;\r\n\r\n  // ----- Create elements (safe) -----\r\n  const el = document.createElement('span');\r\n  el.className = `notice notice--${type} notice--enter`;\r\n  el.setAttribute('role', (type === 'info' ? 'status' : 'alert'));\r\n  el.setAttribute('aria-live', (type === 'info' ? 'polite' : 'assertive'));\r\n  el.tabIndex = -1; // \u0447\u0442\u043E\u0431\u044B \u043C\u043E\u0436\u043D\u043E \u0431\u044B\u043B\u043E \u0444\u043E\u043A\u0443\u0441\u0438\u0440\u043E\u0432\u0430\u0442\u044C\r\n\r\n  // icon wrapper (so CSS can style .notice__icon)\r\n  const iconWrap = document.createElement('span');\r\n  iconWrap.className = 'notice__icon';\r\n  const i = document.createElement('i');\r\n  i.className = chosenIcon;\r\n  i.setAttribute('aria-hidden', 'true');\r\n  iconWrap.appendChild(i);\r\n\r\n  // content\r\n  const content = document.createElement('span');\r\n  content.className = 'notice__content';\r\n\r\n  if (title) {\r\n    const t = document.createElement('span');\r\n    t.className = 'notice__title';\r\n    t.textContent = title; // \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\r\n    content.appendChild(t);\r\n  }\r\n\r\n  if (description) {\r\n    const d = document.createElement('span');\r\n    d.className = 'notice__desc';\r\n    d.textContent = description;\r\n    content.appendChild(d);\r\n  }\r\n\r\n  // close button\r\n  const close = document.createElement('button');\r\n  close.type = 'button';\r\n  close.className = 'notice__close';\r\n  close.setAttribute('aria-label', closeLabel);\r\n  close.innerHTML = '&times;'; // safe: static char\r\n  // assemble\r\n  el.appendChild(iconWrap);\r\n  el.appendChild(content);\r\n  el.appendChild(close);\r\n\r\n  // ----- Animation / removal helpers -----\r\n  let timerId = null;\r\n  let startTs = 0;\r\n  let remaining = timeout;\r\n  let removed = false;\r\n\r\n  const startTimer = () => {\r\n    if (!remaining || remaining <= 0) return;\r\n    startTs = performance.now();\r\n    timerId = setTimeout(() => closeNotice('timeout'), Math.max(0, remaining));\r\n  };\r\n\r\n  const pauseTimer = () => {\r\n    if (timerId) {\r\n      clearTimeout(timerId);\r\n      timerId = null;\r\n      remaining = Math.max(0, remaining - (performance.now() - startTs));\r\n    }\r\n  };\r\n\r\n  // \u0443\u043D\u0438\u0444\u0438\u0446\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u043E\u0435 \u0437\u0430\u043A\u0440\u044B\u0442\u0438\u0435 \u2014 \u0437\u0430\u043F\u0443\u0441\u043A\u0430\u0435\u0442 exit-\u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E \u0438 \u0437\u0430\u0442\u0435\u043C \u0443\u0434\u0430\u043B\u044F\u0435\u0442 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\r\n  const closeNotice = (reason = 'manual') => {\r\n    if (removed) return;\r\n    removed = true;\r\n    // stop timer if any\r\n    if (timerId) { clearTimeout(timerId); timerId = null; }\r\n    // remove enter class and add exit class to trigger CSS animation\r\n    el.classList.remove('notice--enter');\r\n    el.classList.add('notice--exit');\r\n\r\n    // after animation end remove DOM node; fallback timeout if browser didn't fire animationend\r\n    const onAnimEnd = (ev) => {\r\n      // ensure it's our exit animation (name may vary), but we remove regardless\r\n      cleanup();\r\n    };\r\n    const cleanup = () => {\r\n      el.removeEventListener('animationend', onAnimEnd);\r\n      el.removeEventListener('transitionend', onAnimEnd);\r\n      // remove listeners\r\n      el.removeEventListener('mouseenter', pauseTimer);\r\n      el.removeEventListener('mouseleave', startTimer);\r\n      close.removeEventListener('click', onClickClose);\r\n      document.removeEventListener('keydown', onKeyDown);\r\n      // remove node\r\n      if (el.parentNode) el.parentNode.removeChild(el);\r\n      // callback\r\n      if (typeof onClose === 'function') {\r\n        try { onClose(reason); } catch (e) { /* ignore */ }\r\n      }\r\n    };\r\n\r\n    el.addEventListener('animationend', onAnimEnd);\r\n    el.addEventListener('transitionend', onAnimEnd);\r\n\r\n    // fallback: if animationend not fired within 600ms, force cleanup\r\n    setTimeout(() => {\r\n      if (el.parentNode) cleanup();\r\n    }, 700);\r\n  };\r\n\r\n  // click on close\r\n  const onClickClose = (ev) => {\r\n    ev.stopPropagation();\r\n    closeNotice('manual');\r\n  };\r\n  close.addEventListener('click', onClickClose);\r\n\r\n  // pause on hover, resume on leave\r\n  el.addEventListener('mouseenter', () => {\r\n    pauseTimer();\r\n  });\r\n  el.addEventListener('mouseleave', () => {\r\n    // resume only if not already removed\r\n    if (!removed && remaining > 0) startTimer();\r\n  });\r\n\r\n  // Esc handler: close the most-recent-focused notice when Escape pressed\r\n  const onKeyDown = (ev) => {\r\n    if (ev.key === 'Escape' || ev.key === 'Esc') {\r\n      // only close if el contains focus or body focused and el is last child\r\n      if (document.activeElement === el || el.contains(document.activeElement)) {\r\n        ev.preventDefault();\r\n        closeNotice('esc');\r\n      }\r\n    }\r\n  };\r\n  document.addEventListener('keydown', onKeyDown);\r\n\r\n  // add enter animation cleanup (remove enter class after finished)\r\n  const onEnterAnimEnd = () => {\r\n    el.classList.remove('notice--enter');\r\n    el.removeEventListener('animationend', onEnterAnimEnd);\r\n  };\r\n  el.addEventListener('animationend', onEnterAnimEnd);\r\n\r\n  // ----- Insert into DOM -----\r\n  if (appendToTop && stack.firstChild) {\r\n    stack.insertBefore(el, stack.firstChild);\r\n  } else {\r\n    stack.appendChild(el);\r\n  }\r\n\r\n  // set remaining timer and start it if needed\r\n  remaining = timeout;\r\n  if (timeout && timeout > 0) startTimer();\r\n\r\n  // optional autofocus for accessibility (announce + keyboard nav)\r\n  if (autofocus) {\r\n    // slight delay so screenreaders pick up insertion\r\n    setTimeout(() => {\r\n      try { el.focus(); } catch (e) { /* ignore */ }\r\n    }, 50);\r\n  }\r\n\r\n  // return handle with utility methods\r\n  return {\r\n    el,\r\n    close: (reason = 'manual') => closeNotice(reason),\r\n    pause: pauseTimer,\r\n    resume: () => { if (!removed && remaining > 0) startTimer(); },\r\n    isRemoved: () => removed\r\n  };\r\n}\r\n\r\n\r\n}", "/**\r\n * Modal (optimized)\r\n * -----------------\r\n * Improved, robust modal/form helper for BaseTable.\r\n * - Centralized listener management with automatic cleanup\r\n * - Safer focus trap and accessible defaults\r\n * - Robust form serialization (checkboxes, numbers, arrays, files)\r\n * - Clear separation of modal-builder and modal lifecycle\r\n * - Better error handling and consistent logging\r\n *\r\n * Usage: const modal = new Modal(baseTable);\r\n *        const { promise, close } = modal.openEditModal(idOrItem);\r\n *\r\n * @author Calista Verner\r\n * @version 1.5.0\r\n * @license MIT\r\n */\r\n\r\nexport class Modal {\r\n  constructor(baseTable) {\r\n    if (!baseTable) throw new TypeError('Modal requires baseTable');\r\n    this.baseTable = baseTable;\r\n\r\n    // Local records for active modal instance (listeners created by this Modal)\r\n    this._active = null; // { modalBuilder, nodes, listeners: [], resolvedOnce }\r\n\r\n    // convenience aliases\r\n    this.idField = this.baseTable.idField || 'id';\r\n  }\r\n\r\n  // ---------- internal helpers ----------\r\n  _ensureBuilder() {\r\n    return (typeof this.baseTable._ensureModalBuilder === 'function')\r\n      ? this._ensureModalBuilder()\r\n      : this._defaultModalBuilder();\r\n  }\r\n  \r\n  _ensureModalBuilder() {\r\n    if (typeof this.baseTable.ui.modalBuilder === 'function') return this.ui.modalBuilder(this);\r\n    return this._defaultModalBuilder();\r\n  }\r\n  \r\n  async openDeleteConfirm(id) {\r\n    const wrap = this.baseTable._create('div');\r\n    const found = this.baseTable.data.find(r => String(r[this.baseTable.idField]) === String(id)) || {};\r\n    wrap.innerHTML = `<p>\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u043B\u0435\u043C\u0435\u043D\u0442 <strong>${Modal.escapeHtml(found.fullname ?? String(id))}</strong>?</p>\\n      <div style=\"display:flex;gap:8px;justify-content:flex-end;margin-top:12px\">\\n        <button class=\"btn btn-danger btn-confirm\">\u0423\u0434\u0430\u043B\u0438\u0442\u044C</button>\\n        <button class=\"btn btn-secondary btn-cancel\" data-action=\"cancel\">\u041E\u0442\u043C\u0435\u043D\u0430</button>\\n      </div>`;\r\n    const modal = this._ensureModalBuilder(); const m = modal.open('\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F', wrap);\r\n    const confirmBtn = wrap.querySelector('.btn-confirm'); const cancelBtn = wrap.querySelector('.btn-cancel');\r\n    return new Promise((resolve) => {\r\n      cancelBtn.addEventListener('click', () => { modal.close(); resolve(false); });\r\n      confirmBtn.addEventListener('click', async () => {\r\n        try {\r\n          if (!this.baseTable.apis.apiDelete) throw new Error('apiDelete not provided');\r\n          await this.baseTable.apis.apiDelete(id);\r\n          this.baseTable.data = this.baseTable.data.filter(d => String(d[this.baseTable.idField]) !== String(id));\r\n          this.baseTable.applyFiltersAndRender();\r\n          modal.close(); this.baseTable.log('Deleted', id); resolve(true);\r\n        } catch (err) { this.baseTable.error('delete error', err); alert('\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438. \u0421\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u043A\u043E\u043D\u0441\u043E\u043B\u044C.'); modal.close(); resolve(false); }\r\n      }, { once: true });\r\n    });\r\n  }\r\n\r\n  _trackListener(el, ev, fn, opts) {\r\n    // track both in local active list and baseTable._listeners if available\r\n    const rec = { el, ev, fn, opts };\r\n    if (!this._active) this._active = { listeners: [] };\r\n    this._active.listeners.push(rec);\r\n    if (el && typeof el.addEventListener === 'function') el.addEventListener(ev, fn, opts || false);\r\n    if (Array.isArray(this.baseTable._listeners)) this.baseTable._listeners.push(rec);\r\n    return rec;\r\n  }\r\n\r\n  _untrackAll() {\r\n    if (!this._active || !Array.isArray(this._active.listeners)) return;\r\n    for (const r of this._active.listeners.slice()) {\r\n      try { r.el.removeEventListener(r.ev, r.fn, r.opts || false); } catch (e) {}\r\n    }\r\n    // remove tracked listeners from baseTable._listeners if it exists\r\n    if (Array.isArray(this.baseTable._listeners)) {\r\n      this.baseTable._listeners = this.baseTable._listeners.filter(x => !this._active.listeners.includes(x));\r\n    }\r\n    this._active.listeners = [];\r\n  }\r\n\r\n  _safeFocusables(container) {\r\n    try {\r\n      const selector = 'a[href], button, textarea, input, select, [tabindex]:not([tabindex=\"-1\"])';\r\n      return Array.from(container.querySelectorAll(selector)).filter(el => !el.disabled && el.offsetParent !== null);\r\n    } catch (e) { return []; }\r\n  }\r\n\r\n  _serializeForm(form, formSchema = []) {\r\n    // Builds payload with sensible conversions and ensures checkboxes are present\r\n    const fd = new FormData(form);\r\n    const payload = {};\r\n\r\n    // helper to read values for named fields (including multiple values)\r\n    const entries = {};\r\n    for (const [k, v] of fd.entries()) {\r\n      if (!(k in entries)) entries[k] = [];\r\n      entries[k].push(v);\r\n    }\r\n\r\n    for (const [k, vals] of Object.entries(entries)) {\r\n      // if multiple values \u2014 keep array\r\n      if (vals.length > 1) payload[k] = vals;\r\n      else payload[k] = vals[0];\r\n    }\r\n\r\n    // Ensure checkboxes from schema are present\r\n    for (const f of formSchema || []) {\r\n      if (f.type === 'checkbox') {\r\n        const el = form.querySelector(`[name=\"${f.name}\"]`);\r\n        payload[f.name] = !!(el && el.checked);\r\n      }\r\n      if (f.type === 'number') {\r\n        if (payload[f.name] === '' || payload[f.name] === undefined) payload[f.name] = null;\r\n        else if (payload[f.name] !== null) payload[f.name] = Number(String(payload[f.name]).replace(/\\s+/g, '').replace(',', '.'));\r\n      }\r\n      // arrays (multi-select) \u2014 normalize\r\n      if (f.type === 'array') {\r\n        const els = form.querySelectorAll(`[name=\"${f.name}\"]`);\r\n        if (els && els.length > 0) {\r\n          const vals = [];\r\n          els.forEach(e => {\r\n            if (e.options) { // select\r\n              Array.from(e.selectedOptions).forEach(opt => vals.push(opt.value));\r\n            } else if (e.type === 'checkbox') {\r\n              if (e.checked) vals.push(e.value);\r\n            }\r\n          });\r\n          payload[f.name] = vals;\r\n        }\r\n      }\r\n    }\r\n\r\n    return payload;\r\n  }\r\n\r\n  _resolveResponse(res) {\r\n    // Normalize common response shapes: { success:true, data: {...} } or raw object\r\n    try {\r\n      if (!res) return res;\r\n      if (typeof res === 'object') {\r\n        if ('data' in res) return res.data;\r\n        if ('result' in res) return res.result;\r\n        return res;\r\n      }\r\n      return res;\r\n    } catch (e) { return res; }\r\n  }\r\n\r\n  // ---------- core modal lifecycle ----------\r\n  _openFormForItem(initial = {}, opts = {}) {\r\n    // ensure previous modal closed and cleaned up\r\n    if (this.baseTable._modal) this._closeModal();\r\n\r\n    const modalBuilder = opts.modalBuilder || this._ensureBuilder();\r\n    const title = (initial && initial[this.idField]) ? (opts.title || '\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C') : (opts.title || '\u041D\u043E\u0432\u044B\u0439 \u044D\u043B\u0435\u043C\u0435\u043D\u0442');\r\n\r\n    // build form through baseTable.table._buildFormFromSchema\r\n    const built = (this.baseTable.table && typeof this.baseTable.table._buildFormFromSchema === 'function')\r\n      ? this.baseTable.table._buildFormFromSchema(initial || {})\r\n      : (initial || {});\r\n\r\n    const containerNode = (built && built.form instanceof Node) ? built.form : (built || document.createElement('div'));\r\n    const m = modalBuilder.open(title, (containerNode instanceof Node) ? containerNode : (containerNode.form || containerNode));\r\n\r\n    const dialog = (m && m.dialog) ? m.dialog : (m);\r\n    const form = (containerNode && containerNode.form) ? containerNode.form : (containerNode.tagName === 'FORM' ? containerNode : null);\r\n\r\n    // prepare active record\r\n    this._active = { modalBuilder, m, dialog, form, listeners: [], resolvedOnce: false };\r\n\r\n    // accessible focus trap\r\n    const focusables = this._safeFocusables(dialog);\r\n    const firstFocusable = focusables[0] || null;\r\n    const lastFocusable = focusables[focusables.length - 1] || firstFocusable;\r\n\r\n    const trap = (e) => {\r\n      if (e.key === 'Tab') {\r\n        if (focusables.length === 0) { e.preventDefault(); return; }\r\n        if (e.shiftKey && document.activeElement === firstFocusable) {\r\n          e.preventDefault(); lastFocusable.focus();\r\n        } else if (!e.shiftKey && document.activeElement === lastFocusable) {\r\n          e.preventDefault(); firstFocusable.focus();\r\n        }\r\n      } else if (e.key === 'Escape') {\r\n        e.preventDefault(); cancelHandler();\r\n      }\r\n    };\r\n\r\n    this._trackListener(dialog, 'keydown', trap);\r\n\r\n    const that = this;\r\n    let resolvePromise;\r\n    const promise = new Promise((resolve) => { resolvePromise = resolve; });\r\n\r\n    const cleanupAndResolve = (value) => {\r\n      // prevent multiple resolves\r\n      if (this._active && this._active.resolvedOnce) return;\r\n      if (this._active) this._active.resolvedOnce = true;\r\n      try { this._untrackAll(); } catch (e) {}\r\n      try { if (modalBuilder && typeof modalBuilder.close === 'function') modalBuilder.close(); } catch (e) {}\r\n      resolvePromise(value);\r\n    };\r\n\r\n    // submit handler\r\n    const submitHandler = async (ev) => {\r\n      try {\r\n        ev && ev.preventDefault();\r\n        if (!this._active || this.baseTable._isSaving) return;\r\n        if (!form) { alert('\u0424\u043E\u0440\u043C\u0430 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430'); cleanupAndResolve(null); return; }\r\n        if (!form.checkValidity()) { form.reportValidity(); return; }\r\n\r\n        const payload = this._serializeForm(form, this.baseTable.formSchema || []);\r\n\r\n        // preserve id if provided initially\r\n        if (initial && initial[this.idField] !== undefined && !payload[this.idField]) payload[this.idField] = initial[this.idField];\r\n\r\n        this.baseTable._isSaving = true;\r\n        let saved = null;\r\n        try {\r\n          let res;\r\n          if (!payload[this.idField]) {\r\n            if (!this.baseTable.apis || !this.baseTable.apis.apiAdd) throw new Error('apiAdd not provided');\r\n            res = await this.baseTable.apis.apiAdd(payload);\r\n          } else {\r\n            if (!this.baseTable.apis || !this.baseTable.apis.apiUpdate) throw new Error('apiUpdate not provided');\r\n            res = await this.baseTable.apis.apiUpdate(payload[this.idField], payload);\r\n          }\r\n          saved = this._resolveResponse(res) || payload;\r\n\r\n          // merge into local dataset\r\n          if (!payload[this.idField]) {\r\n            const added = (saved && saved[this.idField] !== undefined) ? saved : Object.assign({ [this.idField]: Date.now() }, saved);\r\n            this.baseTable.data.unshift(added);\r\n          } else {\r\n            const idx = this.baseTable.data.findIndex(d => String(d[this.idField]) === String(payload[this.idField]));\r\n            if (idx === -1) this.baseTable.data.unshift(saved);\r\n            else this.baseTable.data[idx] = this.baseTable._mergeLocalItem ? this.baseTable._mergeLocalItem(this.baseTable.data[idx], saved) : Object.assign({}, this.baseTable.data[idx], saved);\r\n          }\r\n\r\n          if (this.baseTable.log) this.baseTable.log('Saved item', saved);\r\n          cleanupAndResolve(saved);\r\n        } catch (err) {\r\n          if (this.baseTable.error) this.baseTable.error('modal save error', err);\r\n          try { console.error(err); } catch (e) {}\r\n          // keep modal open for correction; resolve null to calling code\r\n          alert('\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u0438. \u0421\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u043A\u043E\u043D\u0441\u043E\u043B\u044C.');\r\n          cleanupAndResolve(null);\r\n        } finally {\r\n          this.baseTable._isSaving = false;\r\n        }\r\n      } catch (e) {\r\n        cleanupAndResolve(null);\r\n      }\r\n    };\r\n\r\n    // attach submit\r\n    if (form) this._trackListener(form, 'submit', submitHandler);\r\n\r\n    // cancel handler\r\n    const cancelHandler = () => {\r\n      cleanupAndResolve(null);\r\n    };\r\n\r\n    // attach cancel buttons (data-action=\"cancel\")\r\n    if (form) {\r\n      const cancelBtn = form.querySelector('[data-action=\"cancel\"]');\r\n      if (cancelBtn) this._trackListener(cancelBtn, 'click', (e) => { e.preventDefault(); cancelHandler(); });\r\n    }\r\n\r\n    // attach close button (dialog-level)\r\n    const closeBtn = dialog.querySelector('button[data-action=\"close\"]') || dialog.querySelector('.btn-ghost');\r\n    if (closeBtn) this._trackListener(closeBtn, 'click', (e) => { e && e.preventDefault(); cancelHandler(); });\r\n\r\n    // final focus to first focusable\r\n    setTimeout(() => {\r\n      const focusables2 = this._safeFocusables(dialog);\r\n      const focusEl = focusables2[0] || dialog.querySelector('input,select,textarea,button');\r\n      if (focusEl && typeof focusEl.focus === 'function') try { focusEl.focus(); } catch (e) {}\r\n    }, 40);\r\n\r\n    return {\r\n      promise,\r\n      close: () => cleanupAndResolve(null)\r\n    };\r\n  }\r\n\r\n  async openEditModal(idOrItem, opts = {}) {\r\n    const item = (typeof idOrItem === 'object') ? idOrItem : this.baseTable.data.find(d => String(d[this.idField]) === String(idOrItem));\r\n    const { promise } = this._openFormForItem(item || { [this.idField]: idOrItem }, opts);\r\n    const saved = await promise;\r\n\r\n    if (saved) {\r\n      if (typeof saved.type === 'string' && saved.type === 'success') {\r\n        try { this.baseTable.applyFiltersAndRender(); } catch (e) {}\r\n        this._closeModal();\r\n        try { this.baseTable.refresh && this.baseTable.refresh(); } catch (e) {}\r\n      }\r\n    }\r\n\r\n    // optional notify via jquery if available\r\n    try {\r\n      const table = document.querySelector('table');\r\n      if (table && window.$) $(table).notify(saved?.message, saved?.type);\r\n    } catch (e) {}\r\n\r\n    return saved;\r\n  }\r\n\r\n  async openAddModal(opts = {}) {\r\n    const { promise } = this._openFormForItem({}, opts);\r\n    const saved = await promise;\r\n    if (saved) {\r\n      try { this.baseTable.applyFiltersAndRender(); } catch (e) {}\r\n    }\r\n    this._closeModal();\r\n    return saved;\r\n  }\r\n\r\n  _defaultModalBuilder() {\r\n    const base = this.baseTable;\r\n    return {\r\n      open: (title, contentNode) => {\r\n        if (base._modal) this._closeModal();\r\n        const overlay = base._create('div', { className: 'pe-modal-overlay', attrs: { role: 'dialog', 'aria-modal': 'true' } });\r\n        const dialog = base._create('div', { className: 'pe-modal-dialog' });\r\n        overlay.appendChild(dialog);\r\n        document.body.appendChild(overlay);\r\n        base._modal = { overlay, dialog, focusRestore: document.activeElement };\r\n\r\n        const header = base._create('div', { className: 'pe-modal-header' });\r\n        const h = base._create('h4', { className: 'modal-title', text: title });\r\n        const close = base._create('button', { className: 'btn btn-ghost', text: '\u2715', attrs: { 'data-action': 'close', 'aria-label': 'Close' } });\r\n        header.appendChild(h); header.appendChild(close);\r\n        dialog.appendChild(header);\r\n\r\n        const content = base._create('div', { className: 'pe-modal-content' });\r\n        if (typeof contentNode === 'string') content.innerHTML = contentNode;\r\n        else if (contentNode instanceof Node) content.appendChild(contentNode);\r\n        dialog.appendChild(content);\r\n\r\n        overlay.style.display = 'flex';\r\n\r\n        // click outside closes\r\n        overlay.addEventListener('click', (e) => { if (e.target === overlay) this._closeModal(); });\r\n        close.addEventListener('click', () => this._closeModal());\r\n\r\n        setTimeout(() => {\r\n          const focusEl = dialog.querySelector('input,select,textarea,button');\r\n          if (focusEl) try { focusEl.focus(); } catch (e) {}\r\n        }, 40);\r\n\r\n        return { overlay, dialog };\r\n      },\r\n      close: () => this._closeModal()\r\n    };\r\n  }\r\n\r\n  _closeModal() {\r\n    // cleanup active listeners created by Modal\r\n    try {\r\n      this._untrackAll();\r\n    } catch (e) {}\r\n\r\n    try {\r\n      if (this.baseTable._modal) {\r\n        const { overlay, focusRestore } = this.baseTable._modal;\r\n        try { overlay.remove(); } catch (e) {}\r\n        if (focusRestore && typeof focusRestore.focus === 'function') try { focusRestore.focus(); } catch (e) {}\r\n      }\r\n    } catch (e) { if (this.baseTable.warn) this.baseTable.warn('_closeModal error', e); }\r\n\r\n    this.baseTable._modal = null;\r\n    this._active = null;\r\n  }\r\n  \r\n  static escapeHtml(s) { return String(s ?? '').replace(/[&<>\\\"']/g, m => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;' }[m])); }\r\n}", "export class Fetcher {\r\n\tconstructor(baseTable){\r\n\t\tthis.baseTable = baseTable;\r\n\t}\r\n\t\r\n\tasync fetchRefs() {\r\n    if (this.baseTable._refsLoading) return this.baseTable._refsLoading;\r\n    if (this.baseTable._refsLoaded && this.baseTable.refs && Object.keys(this.baseTable.refs).length) return this.baseTable.refs;\r\n\r\n    const refsMap = this.baseTable.apis.refs || {};\r\n    const keys = Object.keys(refsMap);\r\n    if (!keys.length) { this.baseTable.refs = {}; this.baseTable._refsLoaded = true; return {}; }\r\n\r\n    this.baseTable._refsLoading = (async () => {\r\n      try {\r\n        this.baseTable.showLoading('\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u043E\u0432...');\r\n        const calls = keys.map(k => {\r\n          const v = refsMap[k];\r\n          try { if (typeof v === 'function') return Promise.resolve(v()); if (v && typeof v.then === 'function') return v; return Promise.resolve(v); } catch (e) { return Promise.resolve([]); }\r\n        });\r\n\r\n        const settled = await Promise.allSettled(calls);\r\n        keys.forEach((k, i) => {\r\n          const r = settled[i];\r\n          if (r.status === 'fulfilled') this.baseTable.refs[k] = this.baseTable._normalizeListResponse(r.value); else { this.baseTable.error(`ref \"${k}\" load failed`, r.reason); this.baseTable.refs[k] = []; }\r\n        });\r\n\r\n        this.baseTable.log('refs loaded', Object.keys(this.baseTable.refs).map(k => `${k}(${(this.baseTable.refs[k] || []).length})`).join(', '));\r\n        this.baseTable._refsLoaded = true;\r\n        return this.baseTable.refs;\r\n      } catch (err) {\r\n        this.baseTable.error('fetchRefs error', err);\r\n        this.baseTable.refs = {};\r\n        this.baseTable._refsLoaded = true;\r\n        return {};\r\n      } finally { this.baseTable.hideLoading(); this.baseTable._refsLoading = null; }\r\n    })();\r\n\r\n    return this.baseTable._refsLoading;\r\n  }\r\n  \r\n    async fetchItems() {\r\n    try {\r\n      this.baseTable.showLoading('\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0434\u0430\u043D\u043D\u044B\u0445...');\r\n      let call = this.baseTable.apis.apiCall;\r\n      if (!call) {\r\n        if (this.baseTable.adminPanel?.foxEngine?.sendPostAndGetAnswer) call = () => this.baseTable.adminPanel.foxEngine.sendPostAndGetAnswer({ sysRequest: 'getCategories' }, 'JSON');\r\n        else if (typeof foxEngine !== 'undefined' && foxEngine.sendPostAndGetAnswer) call = () => foxEngine.sendPostAndGetAnswer({ sysRequest: 'getCategories' }, 'JSON');\r\n        else throw new Error('apiCall not provided');\r\n      }\r\n      const res = await call();\r\n      const list = this.baseTable._normalizeListResponse(res);\r\n      this.baseTable.log('items fetched', (list && list.length) || 0);\r\n      return list;\r\n    } catch (err) {\r\n      this.baseTable.error('fetchItems error', err);\r\n      return [];\r\n    } finally { setTimeout(() => this.baseTable.hideLoading(), 200); }\r\n  }\r\n}", "/**\r\n * RendererRegistry (optimized)\r\n * ----------------------------\r\n * Responsible for registering and invoking cell-type renderers for BaseTable.\r\n * This file contains an improved, safer and higher-performance implementation\r\n * of the original RendererRegistry.\r\n *\r\n * Key improvements:\r\n *  - explicit API: register / get / render\r\n *  - normalized type keys and validation\r\n *  - better DOM performance (DocumentFragment / small helper factories)\r\n *  - safer URL handling and currency escaping\r\n *  - robust JSON rendering with limits and linkify option\r\n *  - consistent fallbacks for invalid inputs\r\n *\r\n * Usage: const reg = new RendererRegistry(baseTable);\r\n *        reg.registerTypeRenderer('myType', (td, val, col, row) => { ... });\r\n *        // BaseTable should call reg.renderCell(type, td, value, col, row)\r\n *\r\n * @author Calista Verner\r\n * @version 1.5.0\r\n * @license MIT\r\n */\r\n\r\nexport class RendererRegistry {\r\n  /**\r\n   * @param {Object} baseTable \u2014 instance of BaseTable-like object expected to\r\n   *   expose helpers: _create(tag, opts), placeholderSVG(w,h),\r\n   *   _valueForField(key, row), _parseToDate(v), options, log(...)\r\n   */\r\n  constructor(baseTable) {\r\n    if (!baseTable) throw new TypeError('RendererRegistry requires baseTable');\r\n    this.baseTable = baseTable;\r\n    // map of type -> rendererFn\r\n    this.typeRenderers = new Map();\r\n\r\n    // register builtin renderers\r\n    this._registerDefaults();\r\n  }\r\n\r\n  // ----------------------- utilities -----------------------\r\n  _normalizeType(type) {\r\n    return String(type ?? '').trim().toLowerCase();\r\n  }\r\n\r\n  _createEl(tag, opts = {}) {\r\n    // prefer baseTable._create if available for consistent markup\r\n    if (typeof this.baseTable._create === 'function') {\r\n      return this.baseTable._create(tag, opts);\r\n    }\r\n    const el = document.createElement(tag);\r\n    if (opts.text) el.textContent = opts.text;\r\n    if (opts.attrs) Object.entries(opts.attrs).forEach(([k, v]) => el.setAttribute(k, String(v)));\r\n    if (opts.className) el.className = opts.className;\r\n    return el;\r\n  }\r\n\r\n  _safeHref(href) {\r\n    if (!href) return '';\r\n    const s = String(href).trim();\r\n    const allowed = /^(https?:|mailto:|\\/)/i;\r\n    return allowed.test(s) ? s : '//' + s.replace(/^[\\/]+/, '');\r\n  }\r\n\r\n  // ----------------------- public API -----------------------\r\n  /**\r\n   * Register a renderer function for a given type.\r\n   * @param {string} type\r\n   * @param {(td:HTMLElement, val:any, col:object, row:object)=>void} fn\r\n   */\r\n  registerTypeRenderer(type, fn) {\r\n    if (!type || typeof fn !== 'function') {\r\n      throw new Error('registerTypeRenderer(type, fn) invalid args');\r\n    }\r\n    const key = this._normalizeType(type);\r\n    this.typeRenderers.set(key, fn);\r\n    if (this.baseTable && typeof this.baseTable.log === 'function') {\r\n      this.baseTable.log(`Registered renderer: ${key}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render a cell using the renderer for `type` (fallback to 'text').\r\n   * This is the method BaseTable should call when filling a td.\r\n   * @param {string} type\r\n   * @param {HTMLElement} td\r\n   * @param {*} val\r\n   * @param {object} col\r\n   * @param {object} row\r\n   */\r\n  renderCell(type, td, val, col = {}, row = {}) {\r\n    const renderer = this.getRenderer(type) || this.getRenderer('text');\r\n    try {\r\n      renderer.call(this, td, val, col, row);\r\n    } catch (err) {\r\n      // fail gracefully: show string fallback and log error\r\n      td.textContent = String(val ?? '\u2014');\r\n      if (this.baseTable && typeof this.baseTable.log === 'function')\r\n        this.baseTable.log('Renderer error for type ' + type + ': ' + (err && err.message));\r\n    }\r\n  }\r\n\r\n  // ----------------------- default renderers -----------------------\r\n  _registerDefaults() {\r\n    // TEXT\r\n\tthis.registerTypeRenderer('text', (td, val, col = {}) => {\r\n\t  const s = (val === null || val === undefined) ? '' : String(val);\r\n\t  const GLOBAL_MAX = 128;\r\n\t  // \u0435\u0441\u043B\u0438 \u043A\u043E\u043B\u043E\u043D\u043A\u0430 \u0437\u0430\u0434\u0430\u0451\u0442 \u043C\u0435\u043D\u044C\u0448\u0438\u0439 \u043F\u0440\u0435\u0434\u0435\u043B \u2014 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u0435\u0433\u043E, \u0438\u043D\u0430\u0447\u0435 \u0431\u0435\u0440\u0435\u043C \u0433\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043B\u0438\u043C\u0438\u0442\r\n\t  const configured = Number.isFinite(col.maxLength) ? col.maxLength : (Number.isFinite(col.truncate) ? col.truncate : 0);\r\n\t  const max = configured > 0 ? Math.min(GLOBAL_MAX, configured) : GLOBAL_MAX;\r\n\r\n\t  if (max > 0 && s.length > max) {\r\n\t\t// \u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C \u043C\u0435\u0441\u0442\u043E \u043F\u043E\u0434 \u0442\u0440\u0438 \u0442\u043E\u0447\u043A\u0438 '...'\r\n\t\tconst keep = Math.max(0, max - 3);\r\n\t\tconst short = s.slice(0, keep) + '...';\r\n\t\tconst span = this._createEl('span', { text: short });\r\n\t\tspan.title = s;\r\n\t\ttd.appendChild(span);\r\n\t  } else {\r\n\t\ttd.textContent = s;\r\n\t  }\r\n\t});\r\n\r\n\r\n    // LINK\r\n    this.registerTypeRenderer('link', (td, val, col = {}, row = {}) => {\r\n      if (!val) {\r\n        td.textContent = '\u2014';\r\n        return;\r\n      }\r\n      const href = this._safeHref(val);\r\n      const a = this._createEl('a', { attrs: { href, target: '_blank', rel: 'noopener noreferrer' } });\r\n      const display = col.textKey ? (this.baseTable._valueForField(col.textKey, row) || '') : (col.display || String(val));\r\n      a.textContent = display;\r\n      td.appendChild(a);\r\n    });\r\n\r\n    // IMAGE\r\nthis.registerTypeRenderer('image', (td, val, col = {}) => {\r\n  const img = document.createElement('img');\r\n  img.className = 'image';\r\n  img.loading = 'lazy';\r\n\r\n  // alt: \u043F\u0440\u0438\u043E\u0440\u0438\u0442\u0435\u0442 \u2014 \u043A\u043B\u044E\u0447 \u0438\u0437 \u0434\u0430\u043D\u043D\u044B\u0445, \u0437\u0430\u0442\u0435\u043C altText\r\n  img.alt = (col.altKey ? (this.baseTable._valueForField(col.altKey, {}) || '') : (col.altText || ''));\r\n\r\n  // \u041F\u043E\u043B\u0443\u0447\u0430\u0435\u043C \u043A\u0430\u043D\u0434\u0438\u0434\u0430\u0442(\u044B) \u043D\u0430 src:\r\n  let srcCandidate = '';\r\n  let original = val;\r\n\r\n  // 1) \u0415\u0441\u043B\u0438 \u0443\u0436\u0435 \u043C\u0430\u0441\u0441\u0438\u0432 \u2014 \u0431\u0435\u0440\u0435\u043C \u043F\u0435\u0440\u0432\u044B\u0439 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\r\n  if (Array.isArray(val)) {\r\n    original = val;\r\n    srcCandidate = val.length ? val[0] : '';\r\n  } else if (typeof val === 'string') {\r\n    // \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0435\u043C \u0440\u0430\u0441\u043F\u0430\u0440\u0441\u0438\u0442\u044C JSON (\u043D\u0430 \u0441\u043B\u0443\u0447\u0430\u0439, \u0435\u0441\u043B\u0438 val \u2014 JSON-\u043C\u0430\u0441\u0441\u0438\u0432)\r\n    const trimmed = val.trim();\r\n    if (trimmed.startsWith('[') || trimmed.startsWith('{')) {\r\n      try {\r\n        const parsed = JSON.parse(trimmed);\r\n        if (Array.isArray(parsed)) {\r\n          original = parsed;\r\n          srcCandidate = parsed.length ? parsed[0] : '';\r\n        } else if (parsed && typeof parsed === 'object') {\r\n          original = parsed;\r\n          // \u0435\u0441\u043B\u0438 \u044D\u0442\u043E \u043E\u0431\u044A\u0435\u043A\u0442 \u2014 \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0435\u043C \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u0451\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u044F\r\n          srcCandidate = parsed.path || parsed.url || parsed.src || parsed.file || '';\r\n        } else {\r\n          srcCandidate = val;\r\n        }\r\n      } catch (e) {\r\n        // \u041D\u0435 JSON \u2014 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u0441\u0442\u0440\u043E\u043A\u0443 \u043A\u0430\u043A \u0435\u0441\u0442\u044C\r\n        srcCandidate = val;\r\n      }\r\n    } else {\r\n      // \u041F\u0440\u043E\u0441\u0442\u0430\u044F \u0441\u0442\u0440\u043E\u043A\u0430 \u2014 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u044D\u0442\u043E \u043F\u0440\u044F\u043C\u043E\u0439 \u043F\u0443\u0442\u044C\r\n      srcCandidate = val;\r\n    }\r\n  } else if (val && typeof val === 'object') {\r\n    // val \u2014 \u043E\u0431\u044A\u0435\u043A\u0442 (\u043D\u0435 \u043C\u0430\u0441\u0441\u0438\u0432)\r\n    original = val;\r\n    srcCandidate = val.path || val.url || val.src || val.file || '';\r\n  } else {\r\n    srcCandidate = '';\r\n  }\r\n\r\n  // \u0415\u0441\u043B\u0438 \u043F\u0435\u0440\u0432\u044B\u0439 \u043A\u0430\u043D\u0434\u0438\u0434\u0430\u0442 \u2014 \u043E\u0431\u044A\u0435\u043A\u0442, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0435\u043C \u0438\u0437\u0432\u043B\u0435\u0447\u044C \u0438\u0437 \u043D\u0435\u0433\u043E \u043F\u0443\u0442\u044C\r\n  if (srcCandidate && typeof srcCandidate === 'object') {\r\n    img.alt = img.alt || (srcCandidate.alt || srcCandidate.title || '');\r\n    srcCandidate = srcCandidate.path || srcCandidate.url || srcCandidate.src || srcCandidate.file || '';\r\n  }\r\n\r\n  // \u041D\u0430\u043A\u043E\u043D\u0435\u0446, \u0435\u0441\u043B\u0438 \u043D\u0435\u0442 src \u2014 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C placeholder (\u0435\u0441\u043B\u0438 \u0435\u0441\u0442\u044C \u0444\u0443\u043D\u043A\u0446\u0438\u044F)\r\n  const placeholder = (typeof this.baseTable.placeholderSVG === 'function')\r\n    ? this.baseTable.placeholderSVG(80, 80)\r\n    : '';\r\n\r\n  img.src = srcCandidate || placeholder;\r\n\r\n  // \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u043C \u0438\u0441\u0445\u043E\u0434\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0432 data-* \u0434\u043B\u044F \u0434\u0435\u0431\u0430\u0433\u0430/\u0434\u043E\u0441\u0442\u0443\u043F\u0430\r\n  try {\r\n    if (original !== undefined) img.dataset._original = (typeof original === 'string' ? original : JSON.stringify(original));\r\n  } catch (e) { /* ignore circular */ }\r\n\r\n  img.addEventListener('error', () => {\r\n    try {\r\n      img.src = placeholder;\r\n    } catch (e) { /* ignore */ }\r\n  });\r\n\r\n  td.appendChild(img);\r\n});\r\n\r\n\r\n    // DATE\r\n    this.registerTypeRenderer('date', (td, val, col = {}) => {\r\n      if (val === undefined || val === null || val === '') {\r\n        td.textContent = '\u2014';\r\n        return;\r\n      }\r\n      const date = this.baseTable._parseToDate ? this.baseTable._parseToDate(val) : new Date(val);\r\n      if (!date || isNaN(date.getTime())) {\r\n        td.textContent = String(val);\r\n        return;\r\n      }\r\n      const opts = col.dateFormat || { year: 'numeric', month: 'short', day: '2-digit', hour: '2-digit', minute: '2-digit' };\r\n      try {\r\n        const txt = date.toLocaleString(col.locale || (this.baseTable.options && this.baseTable.options.locale) || 'ru-RU', opts);\r\n        td.textContent = txt;\r\n        td.title = date.toISOString();\r\n        td.setAttribute('data-timestamp', String(Math.floor(date.getTime() / 1000)));\r\n        td.classList.add('unixDate');\r\n      } catch (e) {\r\n        td.textContent = date.toString();\r\n      }\r\n    });\r\n\r\n    // NUMBER\r\n    this.registerTypeRenderer('number', (td, val, col = {}) => {\r\n      const n = Number(val);\r\n      if (Number.isNaN(n)) {\r\n        td.textContent = String(val ?? '\u2014');\r\n        return;\r\n      }\r\n      if (typeof col.formatPrice === 'function') {\r\n        td.textContent = col.formatPrice(n);\r\n        return;\r\n      }\r\n      const locale = col.locale || (this.baseTable.options && this.baseTable.options.locale) || undefined;\r\n      td.textContent = n.toLocaleString(locale);\r\n    });\r\n\r\n    // BOOLEAN\r\n    this.registerTypeRenderer('boolean', (td, val) => {\r\n      td.textContent = (!!val) ? '\u0414\u0430' : '\u041D\u0435\u0442';\r\n    });\r\n\r\n    // PRICE\r\n    this.registerTypeRenderer('price', (td, val, col = {}, row = {}) => {\r\n      let raw = val;\r\n      if (raw === undefined || raw === null || raw === '') raw = 0;\r\n      // allow strings with spaces or comma\r\n      if (typeof raw === 'string') raw = Number(raw.replace(/\\s+/g, '').replace(',', '.'));\r\n      const n = Number.isFinite(raw) ? raw : 0;\r\n      const currency = String(col.currency || (this.baseTable.options && this.baseTable.options.currency) || 'RUB').toUpperCase();\r\n      const maxFrac = (typeof col.maximumFractionDigits === 'number') ? col.maximumFractionDigits : 0;\r\n      const locale = col.locale || (this.baseTable.options && this.baseTable.options.locale) || 'ru-RU';\r\n\r\n      // create DOM safely instead of innerHTML\r\n      const wrapper = this._createEl('div', { className: 'price', attrs: { 'data-currency': (this.baseTable.escapeHtml ? this.baseTable.escapeHtml(currency) : currency) } });\r\n      try {\r\n        const fmt = new Intl.NumberFormat(locale, { style: 'currency', currency, maximumFractionDigits: maxFrac, minimumFractionDigits: 0 });\r\n        wrapper.textContent = fmt.format(n);\r\n      } catch (e) {\r\n        wrapper.textContent = `${n.toLocaleString(locale, { maximumFractionDigits: maxFrac })} ${currency}`.trim();\r\n      }\r\n      td.appendChild(wrapper);\r\n      try { td.setAttribute('data-raw', String(n)); } catch (_) {}\r\n      td.classList.add('cell-price');\r\n    });\r\n\r\n    // JSON\r\n    this.registerTypeRenderer('json', (td, val, col = {}) => {\r\n      if (val === undefined || val === null || val === '') {\r\n        td.textContent = '\u2014';\r\n        return;\r\n      }\r\n\r\n      let obj = val;\r\n      if (typeof val === 'string') {\r\n        try { obj = JSON.parse(val); } catch (e) { td.textContent = String(val); return; }\r\n      }\r\n\r\n      const maxDepth = Number.isFinite(col.maxDepth) ? Math.max(0, col.maxDepth) : 2;\r\n      const maxItems = Number.isFinite(col.maxItems) ? Math.max(1, col.maxItems) : 50;\r\n      const linkify = col.linkify === true;\r\n\r\n      const renderPrimitive = (v) => {\r\n        if (v === null || v === undefined) return document.createTextNode('\u2014');\r\n        if (typeof v === 'string') {\r\n          if (linkify && /^(https?:\\/\\/|\\/\\/)/i.test(v)) {\r\n            const a = document.createElement('a');\r\n            a.href = v.startsWith('//') ? (location.protocol + v) : v;\r\n            a.target = '_blank';\r\n            a.rel = 'noopener noreferrer';\r\n            a.textContent = v;\r\n            return a;\r\n          }\r\n          return document.createTextNode(v);\r\n        }\r\n        return document.createTextNode(String(v));\r\n      };\r\n\r\n      const createList = (value, depth = 0) => {\r\n        const ul = document.createElement('ul');\r\n        ul.className = 'bt-json-render';\r\n        ul.style.margin = '6px 0 0 0';\r\n        ul.style.paddingLeft = '18px';\r\n        if (depth > maxDepth) {\r\n          const li = document.createElement('li');\r\n          li.textContent = '\u2026';\r\n          ul.appendChild(li);\r\n          return ul;\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n          const len = Math.min(value.length, maxItems);\r\n          for (let i = 0; i < len; i++) {\r\n            const v = value[i];\r\n            const li = document.createElement('li');\r\n            const strong = document.createElement('strong');\r\n            strong.textContent = `${i}: `;\r\n            li.appendChild(strong);\r\n            if (v && typeof v === 'object') li.appendChild(createList(v, depth + 1));\r\n            else li.appendChild(renderPrimitive(v));\r\n            ul.appendChild(li);\r\n          }\r\n          if (value.length > maxItems) {\r\n            const li = document.createElement('li');\r\n            li.textContent = `... ${value.length - maxItems} more`;\r\n            ul.appendChild(li);\r\n          }\r\n          return ul;\r\n        }\r\n\r\n        if (value && typeof value === 'object') {\r\n          const entries = Object.entries(value);\r\n          const len = Math.min(entries.length, maxItems);\r\n          for (let i = 0; i < len; i++) {\r\n            const [k, v] = entries[i];\r\n            const li = document.createElement('li');\r\n            const keyNode = document.createElement('strong');\r\n            keyNode.textContent = `${k}: `;\r\n            li.appendChild(keyNode);\r\n            if (v && typeof v === 'object') li.appendChild(createList(v, depth + 1));\r\n            else li.appendChild(renderPrimitive(v));\r\n            ul.appendChild(li);\r\n          }\r\n          if (entries.length > maxItems) {\r\n            const li = document.createElement('li');\r\n            li.textContent = `... ${entries.length - maxItems} more`;\r\n            ul.appendChild(li);\r\n          }\r\n          return ul;\r\n        }\r\n\r\n        const li = document.createElement('li');\r\n        li.appendChild(renderPrimitive(value));\r\n        ul.appendChild(li);\r\n        return ul;\r\n      };\r\n\r\n      try {\r\n        td.classList.add('cell-json');\r\n        td.appendChild(createList(obj, 0));\r\n        try { td.setAttribute('data-json', JSON.stringify(obj)); } catch (_) {}\r\n      } catch (err) {\r\n        td.textContent = String(val);\r\n      }\r\n    });\r\n  }\r\n}", "/**\r\n * BaseTable\r\n * Main class for working with the BaseTable\r\n * (OOP improvements, backward-compatible)\r\n *\r\n * Author: Calista Verner\r\n * Version: 1.4.2\r\n * License: MIT\r\n *\r\n * Notes:\r\n *  - This refactor preserves the public API and method names.\r\n *  - Internal structure improved: listener management, clearer helpers,\r\n *    defensive DOM handling, price-mask fix, small readability/DRY changes.\r\n */\r\n\r\nimport {Table} from './Table.js';\r\nimport {Modal} from './Modal.js';\r\nimport {Fetcher} from './Fetcher.js';\r\nimport {RendererRegistry} from './RendererRegistry.js';\r\n\r\nexport class BaseTable {\r\n  constructor(adminPanel = null, options = {}) {\r\n    this.adminPanel = adminPanel;\r\n    this.options = options || {};\r\n\r\n    // --- core collaborators ---\r\n    this.table = new Table(this);\r\n    this.modal = new Modal(this);\r\n    this.renderRegistry = new RendererRegistry(this);\r\n\tthis.fetcher = new Fetcher(this);\r\n\r\n    // --- metadata ---\r\n    this._meta = {\r\n      author: 'Calista Verner',\r\n      version: this.options.version || '1.4.2',\r\n      license: this.options.license || 'MIT'\r\n    };\r\n\r\n    // --- selectors & DOM container ---\r\n    const defaultSelectors = {\r\n      container: this.options.selectors?.container || 'adminContent',\r\n      tbody: this.options.selectors?.tbody || 'tbody',\r\n      search: this.options.selectors?.search || 'search',\r\n      clear: this.options.selectors?.clear || 'clear',\r\n      count: this.options.selectors?.count || 'count',\r\n      noResults: this.options.selectors?.noResults || 'noResults',\r\n      table: this.options.selectors?.table || 'table',\r\n      add: this.options.selectors?.add || 'add',\r\n      loading: this.options.selectors?.loading || 'bt-loading'\r\n    };\r\n\r\n    this.selectors = Object.assign({}, defaultSelectors, this.options.selectors || {});\r\n    this.container = this._resolveContainer(this.selectors.container);\r\n\r\n    // --- config ---\r\n    this.idField = this.options.idField || 'id';\r\n    this.columns = Array.isArray(this.options.columns) ? this.options.columns : [];\r\n    this.formSchema = Array.isArray(this.options.formSchema) ? this.options.formSchema : [];\r\n    this.placeholderLabel = this.options.placeholderLabel || '\u041D\u0435\u0442 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F';\r\n\r\n    this.apis = Object.assign({ apiCall: null, apiAdd: null, apiUpdate: null, apiDelete: null, refs: {} }, this.options.apis || {});\r\n\r\n    this.actions = Array.isArray(this.options.actions) ? this.options.actions : [\r\n      { label: '\u0418\u0437\u043C\u0435\u043D.', action: 'edit', className: 'btn btn-sm btn-outline-primary me-1', title: '\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C' },\r\n      { label: '\u0423\u0434\u0430\u043B.', action: 'delete', className: 'btn btn-sm btn-outline-danger', title: '\u0423\u0434\u0430\u043B\u0438\u0442\u044C' }\r\n    ];\r\n\r\n    this.ui = Object.assign({ showLoadingOverlay: true, loadingSelector: this.selectors.loading, createLoadingElement: null, modalBuilder: null, formBuilder: null }, this.options.ui || {});\r\n\r\n    this.brandTag = this.options.brandName || (adminPanel && adminPanel.brandName) || 'BaseTable';\r\n\r\n    // --- runtime state ---\r\n    this.data = [];\r\n    this.refs = {};\r\n    this._refsLoading = null;\r\n    this._refsLoaded = false;\r\n\r\n    this.state = { q: '', sortBy: null, sortDir: 1 };\r\n\r\n    // DOM references & listeners\r\n    this._els = {};\r\n    this.bound = {};\r\n    this._modal = null;\r\n    this._isSaving = false;\r\n\r\n    // unified listeners registry (for attach/detach)\r\n    // each entry: { el, ev, fn, opts }\r\n    this._listeners = [];\r\n\r\n    this.options.currency = this.options.currency || 'RUB';\r\n\r\n    // small helper bindings\r\n    this._formatNumberToLocale = (n) => {\r\n      try {\r\n        return n.toLocaleString(this.options.locale || 'ru-RU', { maximumFractionDigits: 0 });\r\n      } catch (e) {\r\n        return String(n);\r\n      }\r\n    };\r\n\r\n    // register default renderers (keeps backward compatibility)\r\n    if (typeof this.renderRegistry._registerDefaults === 'function') {\r\n      try { this.renderRegistry._registerDefaults(); } catch (e) { this.error('renderRegistry._registerDefaults failed', e); }\r\n    }\r\n\r\n    // price helpers bound\r\n    this._livePriceInputHandler = this._livePriceInputHandler.bind(this);\r\n    this._priceMaskCleanup = this._priceMaskCleanup.bind(this);\r\n    // fix: attach correct handler (was referencing missing _priceMaskHandler)\r\n    document.addEventListener('focusin', this._priceFocusHandler?.bind(this) || ((e) => { /* noop fallback */ }));\r\n  }\r\n\r\n  // ------------------------- OOP helpers (listeners) -------------------------\r\n  _addListener(el, ev, fn, opts) {\r\n    if (!el || typeof el.addEventListener !== 'function') return;\r\n    el.addEventListener(ev, fn, opts || false);\r\n    this._listeners.push({ el, ev, fn, opts });\r\n  }\r\n\r\n  _removeAllListeners() {\r\n    for (const l of this._listeners.slice()) {\r\n      try { l.el.removeEventListener(l.ev, l.fn, l.opts || false); } catch (e) {}\r\n    }\r\n    this._listeners = [];\r\n  }\r\n\r\n  // ------------------------- Price mask helpers -------------------------\r\n  _priceFocusHandler(e) {\r\n    const el = e.target;\r\n    if (!el || el.tagName !== 'INPUT') return;\r\n    // apply only to fields that likely represent prices\r\n    if (!el.classList.contains('bt-field-price') && !el.dataset.price) return;\r\n    this._applyPriceMaskToElement(el);\r\n  }\r\n\r\n  _livePriceInputHandler(e) {\r\n    const el = e.target;\r\n    if (!el || el.tagName !== 'INPUT') return;\r\n    const raw = String(el.value || '').replace(/\\s+/g, '').replace(/[^\\d,.-]/g, '').replace(',', '.');\r\n    const num = Number(raw);\r\n    if (!Number.isFinite(num)) return;\r\n    const formatted = this._formatNumberToLocale(Math.trunc(num));\r\n    el.value = formatted;\r\n    try { el.setSelectionRange(el.value.length, el.value.length); } catch (e) {}\r\n  }\r\n\r\n  _priceMaskCleanup(el) {\r\n    if (!el) return;\r\n    if (el.dataset) delete el.dataset.priceMaskApplied;\r\n  }\r\n\r\n  _applyPriceMaskToElement(el, initialVal) {\r\n    if (!el || el.tagName !== 'INPUT') return;\r\n    if (el.dataset && el.dataset.priceMaskApplied) {\r\n      // update existing\r\n      if (initialVal === undefined || initialVal === null || String(initialVal) === '') return;\r\n      try {\r\n        if (window.jQuery && typeof jQuery.fn.mask === 'function') {\r\n          jQuery(el).val(String(initialVal)).trigger('input');\r\n          return;\r\n        }\r\n        if (window.jQuery && typeof jQuery.fn.maskMoney === 'function') {\r\n          const num = Number(String(initialVal).replace(/\\s+/g, '').replace(',', '.')) || 0;\r\n          jQuery(el).maskMoney('mask', num);\r\n          return;\r\n        }\r\n      } catch (err) { /* plugin error -> fallback */ }\r\n\r\n      // fallback\r\n      try {\r\n        const raw = String(initialVal).replace(/\\s+/g, '').replace(',', '.');\r\n        const num = Number(raw);\r\n        if (Number.isFinite(num)) el.value = this._formatNumberToLocale(Math.trunc(num));\r\n      } catch (e) {}\r\n      return;\r\n    }\r\n\r\n    if (el.dataset) el.dataset.priceMaskApplied = '1';\r\n\r\n    try {\r\n      if (window.jQuery && typeof jQuery.fn.mask === 'function') {\r\n        jQuery(el).mask('000 000 000 000', { reverse: true });\r\n        if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') jQuery(el).val(String(initialVal)).trigger('input'); else jQuery(el).trigger('input');\r\n        return;\r\n      }\r\n\r\n      if (window.jQuery && typeof jQuery.fn.maskMoney === 'function') {\r\n        jQuery(el).maskMoney({ thousands: ' ', decimal: ',', allowZero: true, precision: 0 });\r\n        if (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') {\r\n          const num = Number(String(initialVal).replace(/\\s+/g, '').replace(',', '.')) || 0;\r\n          jQuery(el).maskMoney('mask', num);\r\n        } else jQuery(el).maskMoney('mask');\r\n        return;\r\n      }\r\n    } catch (err) { /* plugin error -> fallback */ }\r\n\r\n    // fallback: attach input listener via _addListener so it will be cleaned up\r\n    this._addListener(el, 'input', this._livePriceInputHandler);\r\n\r\n    // initial formatting\r\n    try {\r\n      const raw = (initialVal !== undefined && initialVal !== null && String(initialVal) !== '') ? String(initialVal).replace(/\\s+/g, '').replace(',', '.') : (el.value || '').replace(/\\s+/g, '').replace(',', '.');\r\n      const num = Number(raw);\r\n      if (Number.isFinite(num)) el.value = this._formatNumberToLocale(Math.trunc(num));\r\n    } catch (e) {}\r\n  }\r\n\r\n  // ------------------------- misc helpers -------------------------\r\n  meta() { return { ...this._meta }; }\r\n\r\n  _logPrefixStyle() { return ['background:#0ea5a4;color:#fff;padding:4px 8px;border-radius:6px;font-weight:700', 'color:#374151']; }\r\n  _console(method, ...args) {\r\n    try {\r\n      const prefix = `%c ${this.brandTag} %c`;\r\n      console[method](prefix, ...this._logPrefixStyle(), ...args);\r\n    } catch (e) {\r\n      console[method](this.brandTag, ...args);\r\n    }\r\n  }\r\n  log(...args) { this._console('log', ...args); }\r\n  info(...args) { this._console('info', ...args); }\r\n  warn(...args) {\r\n    try {\r\n      const p1 = 'background:#f59e0b;color:#fff;padding:4px 8px;border-radius:6px;font-weight:700';\r\n      console.warn(`%c ${this.brandTag} %c`, p1, 'color:#374151', ...args);\r\n    } catch (e) {\r\n      console.warn(this.brandTag, ...args);\r\n    }\r\n  }\r\n  error(...args) {\r\n    try {\r\n      const p1 = 'background:#ef4444;color:#fff;padding:4px 8px;border-radius:6px;font-weight:700';\r\n      console.error(`%c ${this.brandTag} %c`, p1, 'color:#fff', ...args);\r\n    } catch (e) {\r\n      console.error(this.brandTag, ...args);\r\n    }\r\n  }\r\n\r\n  _resolveContainer(sel) {\r\n    if (!sel) return document.body;\r\n    if (typeof sel === 'string') return document.getElementById(sel) || document.querySelector(sel) || document.body;\r\n    if (sel instanceof HTMLElement) return sel;\r\n    return document.body;\r\n  }\r\n\r\n  _parseToDate(val) {\r\n    if (!val && val !== 0) return null;\r\n    if (val instanceof Date) return val;\r\n    const tryNumber = (v) => { const n = Number(v); if (Number.isNaN(n)) return null; const absStr = String(Math.trunc(Math.abs(n))); if (absStr.length <= 10) return new Date(n * 1000); return new Date(n); };\r\n    if (typeof val === 'number') return tryNumber(val);\r\n    if (typeof val === 'string') {\r\n      const s = val.trim();\r\n      if (/^[+-]?\\d+$/.test(s)) return tryNumber(s);\r\n      const parsed = Date.parse(s);\r\n      if (!Number.isNaN(parsed)) return new Date(parsed);\r\n      return null;\r\n    }\r\n    try { const j = JSON.stringify(val); const parsed = Date.parse(j); if (!Number.isNaN(parsed)) return new Date(parsed); } catch (e) {}\r\n    return null;\r\n  }\r\n\r\n  static escapeHtml(s) { return String(s ?? '').replace(/[&<>\\\"']/g, m => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;' }[m])); }\r\n\r\n  placeholderSVG(w = 80, h = 80, label = null) {\r\n    const text = BaseTable.escapeHtml(label ?? this.placeholderLabel);\r\n    return 'data:image/svg+xml;utf8,' + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${w}\" height=\"${h}\"><rect width=\"100%\" height=\"100%\" fill=\"#f2f6fb\"/><text x=\"50%\" y=\"50%\" fill=\"#9aa6bf\" font-size=\"${Math.max(10, Math.round(w / 8))}\" text-anchor=\"middle\" dominant-baseline=\"middle\">${text}</text></svg>`);\r\n  }\r\n\r\n  getByPath(obj, path) {\r\n    if (!obj || !path) return undefined;\r\n    if (path.indexOf('.') === -1) return obj[path];\r\n    return path.split('.').reduce((cur, p) => (cur && cur[p] !== undefined ? cur[p] : undefined), obj);\r\n  }\r\n\r\n  _inferTypeFromValue(val) {\r\n    if (val == null) return 'text';\r\n    if (typeof val === 'boolean') return 'boolean';\r\n    if (typeof val === 'number') return 'number';\r\n    if (val instanceof Date) return 'date';\r\n    const s = String(val);\r\n    if (/^\\d{4}-\\d{2}-\\d{2}T/.test(s) || /^\\d{4}-\\d{2}-\\d{2}/.test(s) || /^\\d{10,13}$/.test(s)) return 'date';\r\n    if (/\\.(png|jpe?g|gif|webp|svg)(\\?.*)?$/i.test(s)) return 'image';\r\n    if (/^https?:\\/\\//i.test(s) || /^mailto:/i.test(s) || /^\\/\\//.test(s)) return 'link';\r\n    return 'text';\r\n  }\r\n\r\n  _valueForField(field, row) {\r\n    if (!field) return undefined;\r\n    if (typeof field === 'function') return field(row);\r\n    if (typeof field === 'string') return this.getByPath(row, field);\r\n    return undefined;\r\n  }\r\n\r\n  formatLink(href) { return href ? `<a href=\"${BaseTable.escapeHtml(href)}\" target=\"_blank\" rel=\"noopener noreferrer\">${BaseTable.escapeHtml(href)}</a>` : '\u2014'; }\r\n\r\n  formatPrice(v) {\r\n    if (v === null || v === undefined || v === '') return '\u2014';\r\n    const n = Number(v);\r\n    if (Number.isNaN(n)) return String(v);\r\n    return n.toLocaleString(this.options.locale || 'ru-RU', { minimumFractionDigits: 0, maximumFractionDigits: 2 });\r\n  }\r\n\r\n  debounce(fn, ms = 200) { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), ms); }; }\r\n\r\n  _create(tag, opts = {}) {\r\n    const el = document.createElement(tag);\r\n    if (opts.className) el.className = opts.className;\r\n    if (opts.text) el.textContent = opts.text;\r\n    if (opts.html) el.innerHTML = opts.html;\r\n    if (opts.attrs) Object.entries(opts.attrs).forEach(([k, v]) => el.setAttribute(k, v));\r\n    if (opts.props) Object.assign(el, opts.props);\r\n    return el;\r\n  }\r\n\r\n  _normalizeListResponse(res) {\r\n    if (!res) return [];\r\n    if (Array.isArray(res)) return res;\r\n    if (res.result && Array.isArray(res.result)) return res.result;\r\n    if (res.data && Array.isArray(res.data)) return res.data;\r\n    try { if (typeof res === 'string') return JSON.parse(res); } catch (e) {}\r\n    return [];\r\n  }\r\n\r\n  _resolveResponse(res) {\r\n    if (!res) return null;\r\n    let candidate = null;\r\n    if (res.item) candidate = res.item;\r\n    else if (res.created) candidate = res.created;\r\n    else if (res.updated) candidate = res.updated;\r\n    else if (res.data) candidate = res.data;\r\n    else if (res.result) candidate = res.result;\r\n    else candidate = res;\r\n    if (Array.isArray(candidate)) return candidate.length ? candidate[0] : null;\r\n    return candidate;\r\n  }\r\n\r\n  _mergeLocalItem(existing, incoming) { if (!existing) return incoming; return Object.assign({}, existing, incoming); }\r\n\r\n  // ------------------------- DOM helpers & rendering -------------------------\r\n  _ensureEls() {\r\n    const c = this.container || document;\r\n    const sel = this.selectors;\r\n    this._els.tbody = c.querySelector(`#${sel.tbody}`) || c.querySelector(sel.tbody) || this._els.tbody;\r\n    this._els.search = c.querySelector(`#${sel.search}`) || c.querySelector(sel.search) || this._els.search;\r\n    this._els.clear = c.querySelector(`#${sel.clear}`) || c.querySelector(sel.clear) || this._els.clear;\r\n    this._els.count = c.querySelector(`#${sel.count}`) || c.querySelector(sel.count) || this._els.count;\r\n    this._els.noResults = c.querySelector(`#${sel.noResults}`) || c.querySelector(sel.noResults) || this._els.noResults;\r\n    this._els.table = c.querySelector(`#${sel.table}`) || c.querySelector(sel.table) || this._els.table;\r\n    this._els.add = c.querySelector(`#${sel.add}`) || c.querySelector(sel.add) || this._els.add;\r\n    this._els.loading = c.querySelector(`#${this.ui.loadingSelector || sel.loading}`) || c.querySelector(this.ui.loadingSelector || sel.loading) || this._els.loading;\r\n  }\r\n\r\n  _createDefaultLoading() {\r\n    const overlay = this._create('div', { className: 'bt-loading-overlay', attrs: { role: 'status', 'aria-hidden': 'true' } });\r\n    const inner = this._create('div', { className: 'bt-loading-inner', attrs: { 'aria-live': 'polite' } });\r\n    const spinner = this._create('i', { className: 'fa-solid fa-spinner fa-spin bt-fa-spinner', attrs: { 'aria-hidden': 'true' } });\r\n    const label = this._create('div', { className: 'bt-loading-text', text: '\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...' });\r\n    inner.appendChild(spinner); inner.appendChild(label); overlay.appendChild(inner);\r\n    Object.assign(overlay.style, { position: 'absolute', inset: '0', display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'rgba(255,255,255,0.6)', zIndex: 9998, pointerEvents: 'none' });\r\n    Object.assign(inner.style, { display: 'inline-flex', gap: '10px', alignItems: 'center', padding: '8px 12px', borderRadius: '10px', background: 'rgba(255,255,255,0.95)', boxShadow: '0 6px 20px rgba(20,30,50,0.08)', pointerEvents: 'auto' });\r\n    return overlay;\r\n  }\r\n\r\n  showLoading(msg = '') {\r\n    if (!this.ui.showLoadingOverlay) return;\r\n    this._ensureEls();\r\n    if (typeof this.ui.createLoadingElement === 'function') {\r\n      try {\r\n        if (!this._els._customLoading) {\r\n          this._els._customLoading = this.ui.createLoadingElement(this._els.table || this.container, msg);\r\n          if (this._els._customLoading) (this._els.table || this.container || document.body).appendChild(this._els._customLoading);\r\n        }\r\n        if (this._els._customLoading) { this._els._customLoading.style.display = ''; this._els._customLoading.setAttribute('aria-hidden', 'false'); }\r\n      } catch (e) { this.error('createLoadingElement error', e); }\r\n      return;\r\n    }\r\n    if (!this._els._autoLoading) {\r\n      this._els._autoLoading = this._createDefaultLoading();\r\n      const parent = this._els.table || this.container || document.body;\r\n      const cs = getComputedStyle(parent);\r\n      if (cs.position === 'static') parent.style.position = 'relative';\r\n      parent.appendChild(this._els._autoLoading);\r\n    }\r\n    if (msg) { const txt = this._els._autoLoading.querySelector('.bt-loading-text'); if (txt) txt.textContent = msg; }\r\n    this._els._autoLoading.style.display = 'flex'; this._els._autoLoading.setAttribute('aria-hidden', 'false');\r\n  }\r\n\r\n  hideLoading() {\r\n    setTimeout(() => {\r\n      try { if (this._els._customLoading) { this._els._customLoading.style.display = 'none'; this._els._customLoading.setAttribute('aria-hidden', 'true'); } } catch (e) {}\r\n      try { if (this._els.loading) { this._els.loading.style.display = 'none'; this._els.loading.setAttribute('aria-hidden', 'true'); } } catch (e) {}\r\n      try { if (this._els._autoLoading) { this._els._autoLoading.style.display = 'none'; this._els._autoLoading.setAttribute('aria-hidden', 'true'); } } catch (e) {}\r\n    }, 200);\r\n  }\r\n\r\n  createRowFromData(row) {\r\n    const tr = document.createElement('tr');\r\n    if (row[this.idField] !== undefined) tr.dataset.id = String(row[this.idField]);\r\n\r\n    for (const col of this.columns) {\r\n      const td = document.createElement('td');\r\n      if (col.className) td.className = col.className;\r\n      if (col.width) td.style.width = col.width;\r\n      if (col.attrs && typeof col.attrs === 'object') Object.entries(col.attrs).forEach(([k, v]) => td.setAttribute(k, v));\r\n\r\n      const val = this.getByPath(row, col.key);\r\n\r\n      // legacy/custom renderer\r\n      if (typeof col.renderer === 'function') {\r\n        try {\r\n          const out = col.renderer(val, row, { table: this, col });\r\n          if (typeof out === 'string') td.innerHTML = out; else if (out instanceof Node) td.appendChild(out); else td.textContent = out ?? '';\r\n        } catch (e) { this.error('col.renderer error', e); td.textContent = String(val ?? ''); }\r\n        tr.appendChild(td);\r\n        continue;\r\n      }\r\n\r\n      const type = col.type || this._inferTypeFromValue(val);\r\n      // support both old Map API and new accessor on registry\r\n      const renderer = (this.renderRegistry && typeof this.renderRegistry.getRenderer === 'function') ? this.renderRegistry.getRenderer(type) : (this.renderRegistry?.typeRenderers?.get ? this.renderRegistry.typeRenderers.get(type) : undefined);\r\n\r\n      if (typeof renderer !== 'function') { td.textContent = String(val ?? ''); tr.appendChild(td); continue; }\r\n\r\n      try {\r\n        // renderer signature: (td, val, col, row, helpers)\r\n        const helpers = { escapeHtml: BaseTable.escapeHtml, formatPrice: this.formatPrice?.bind(this) };\r\n        renderer.call(this, td, val, col, row, helpers);\r\n      } catch (e) { this.error('type renderer error', e); td.textContent = String(val ?? ''); }\r\n\r\n      tr.appendChild(td);\r\n    }\r\n\r\n    if (this.actions && this.actions.length) {\r\n      const tdActions = document.createElement('td'); tdActions.className = 'text-end';\r\n      for (const a of this.actions) {\r\n        const btn = document.createElement('button'); btn.type = 'button'; btn.className = a.className || 'btn btn-sm btn-outline-secondary'; btn.textContent = a.label; if (a.title) btn.title = a.title; if (a.action) btn.dataset.action = a.action; btn.dataset.id = row[this.idField]; if (a.attrs) Object.entries(a.attrs).forEach(([k, v]) => btn.setAttribute(k, v)); tdActions.appendChild(btn); if (typeof a.after === 'function') { try { a.after(btn, row); } catch (e) { this.error('action.after', e); } }\r\n      }\r\n      tr.appendChild(tdActions);\r\n    }\r\n\r\n    return tr;\r\n  }\r\n\r\n  matches(row, q) {\r\n    if (!q) return true;\r\n    q = q.toLowerCase();\r\n    for (const col of this.columns) {\r\n      const v = String(this.getByPath(row, col.key) ?? '').toLowerCase();\r\n      if (v.includes(q)) return true;\r\n    }\r\n    if (String(this.getByPath(row, this.idField) ?? '').toLowerCase().includes(q)) return true;\r\n    return false;\r\n  }\r\n\r\n  applyFiltersAndRender() {\r\n    let list = (this.data || []).filter(r => this.matches(r, this.state.q));\r\n    if (this.state.sortBy) {\r\n      const key = this.state.sortBy; const dir = this.state.sortDir === 1 ? 1 : -1;\r\n      list.sort((a, b) => {\r\n        let va = a[key], vb = b[key];\r\n        if (typeof va === 'number' || typeof vb === 'number') { va = Number(va || 0); vb = Number(vb || 0); return (va - vb) * dir; }\r\n        va = String(va ?? '').toLowerCase(); vb = String(vb ?? '').toLowerCase(); if (va === vb) return 0; return va > vb ? dir : -dir;\r\n      });\r\n    }\r\n    this.renderTable(list);\r\n  }\r\n\r\n  renderTable(list) {\r\n    this._ensureEls();\r\n    const tbody = this._els.tbody; const countEl = this._els.count; const noResults = this._els.noResults;\r\n    if (!tbody) { this.warn('tbody not found'); return; }\r\n    tbody.innerHTML = '';\r\n    if (!list || !list.length) { if (noResults) noResults.style.display = ''; if (countEl) countEl.textContent = '0'; return; }\r\n    if (noResults) noResults.style.display = 'none';\r\n    const frag = document.createDocumentFragment(); for (const row of list) frag.appendChild(this.createRowFromData(row)); tbody.appendChild(frag); if (countEl) countEl.textContent = `${list.length} \u0437\u0430\u043F\u0438\u0441\u0435\u0439`;\r\n  }\r\n\r\n  attachEvents() {\r\n    this._ensureEls(); const { search, clear, tbody, add } = this._els;\r\n\r\n    if (search) {\r\n      this.bound.onSearch = this.debounce((e) => { this.state.q = e.target.value.trim(); this.applyFiltersAndRender(); }, 180);\r\n      this._addListener(search, 'input', this.bound.onSearch);\r\n    }\r\n\r\n    if (clear) {\r\n      this.bound.onClear = () => { if (this._els.search) this._els.search.value = ''; this.state.q = ''; this.applyFiltersAndRender(); };\r\n      this._addListener(clear, 'click', this.bound.onClear);\r\n    }\r\n\r\n    if (tbody) {\r\n      this.bound.onTbodyClick = async (e) => {\r\n        const btn = e.target.closest('button'); if (!btn) return; const action = btn.dataset.action; const tr = btn.closest('tr'); if (!tr) return; const id = tr.dataset.id;\r\n        if (action === 'edit') return this.modal.openEditModal(id);\r\n        if (action === 'delete') return this.modal.openDeleteConfirm(id);\r\n        if (typeof this.onAction === 'function') { try { await this.onAction(action, id, tr); } catch (err) { this.error('onAction error', err); } }\r\n      };\r\n      this._addListener(tbody, 'click', this.bound.onTbodyClick);\r\n    }\r\n\r\n    if (add) { this.bound.onAdd = () => this.modal.openAddModal(); this._addListener(add, 'click', this.bound.onAdd); }\r\n\r\n    const ths = (this._els.table || document).querySelectorAll('thead th[data-key]');\r\n    this.bound.onHeaderClick = (e) => {\r\n      const th = e.currentTarget; const key = th.dataset.key; if (!key) return; if (this.state.sortBy === key) this.state.sortDir = -this.state.sortDir; else { this.state.sortBy = key; this.state.sortDir = 1; }\r\n      (this._els.table || document).querySelectorAll('.sort-indicator').forEach(el => el.textContent = '');\r\n      const ind = (this._els.table || document).querySelector('#sort-' + key); if (ind) ind.textContent = this.state.sortDir === 1 ? '\u25B2' : '\u25BC';\r\n      this.applyFiltersAndRender();\r\n    };\r\n    ths.forEach(th => this._addListener(th, 'click', this.bound.onHeaderClick));\r\n  }\r\n\r\n  detachEvents() {\r\n    this._removeAllListeners(); this.bound = {};\r\n  }\r\n\r\n  async _ensureRefLoaded(refKey) {\r\n    if (!refKey) return [];\r\n    if (this.refs && Array.isArray(this.refs[refKey]) && this.refs[refKey].length) return this.refs[refKey];\r\n    try {\r\n      const refProvider = (this.apis.refs || {})[refKey];\r\n      if (typeof refProvider === 'function') {\r\n        try { const res = await refProvider(); this.refs[refKey] = this._normalizeListResponse(res); this.log(`ref \"${refKey}\" loaded via provider`, (this.refs[refKey] || []).length); return this.refs[refKey]; } catch (e) { this.error(`ref provider \"${refKey}\" error`, e); }\r\n      }\r\n    } catch (e) { this.error(`_ensureRefLoaded error for ${refKey}`, e); }\r\n    await this.fetcher.fetchRefs();\r\n    return this.refs[refKey] || [];\r\n  }\r\n\r\n  async _populateSelectFromRef(selectEl, field) {\r\n    if (!selectEl) return;\r\n    try {\r\n      const placeholder = selectEl.querySelector('option[aria-placeholder=\"true\"]') || selectEl.querySelector('option:first-child');\r\n      Array.from(selectEl.querySelectorAll('option')).forEach(opt => { if (opt === placeholder) return; opt.remove(); });\r\n\r\n      let optsSource = field.options || null;\r\n      if (!optsSource && field.ref) optsSource = await this._ensureRefLoaded(field.ref);\r\n\r\n      if (!optsSource || !optsSource.length) {\r\n        const tmp = document.createElement('option'); tmp.value = ''; tmp.disabled = true; tmp.selected = true; tmp.textContent = field.ref ? '\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445' : '\u041D\u0435\u0442 \u043E\u043F\u0446\u0438\u0439'; selectEl.appendChild(tmp); return;\r\n      }\r\n\r\n      for (const o of optsSource) { const { value, label } = this._mapOptionValueLabel(o, field); const opt = document.createElement('option'); opt.value = value; opt.textContent = label; opt.title = label; selectEl.appendChild(opt); }\r\n      if (placeholder && placeholder.parentNode === selectEl) selectEl.insertBefore(placeholder, selectEl.firstChild);\r\n    } catch (e) { this.error('_populateSelectFromRef error', e); }\r\n  }\r\n\r\n  _mapOptionValueLabel(opt, schemaField = {}) {\r\n    if (typeof opt === 'string' || typeof opt === 'number') return { value: String(opt), label: String(opt) };\r\n    const valueKey = schemaField.valueKey || schemaField.valueProp || 'name';\r\n    const labelKey = schemaField.labelKey || schemaField.labelProp || 'fullname';\r\n    const candidates = [valueKey, 'value', 'id', 'name'];\r\n    const labelCandidates = [labelKey, 'name', 'fullname', 'label', 'title'];\r\n    let value; for (const k of candidates) if (opt[k] !== undefined && opt[k] !== null) { value = opt[k]; break; }\r\n    let label; for (const k of labelCandidates) if (opt[k] !== undefined && opt[k] !== null) { label = opt[k]; break; }\r\n    if (value === undefined) value = (opt.value ?? opt.id ?? opt.name ?? JSON.stringify(opt));\r\n    if (label === undefined) label = (opt.name ?? opt.fullname ?? opt.label ?? String(value));\r\n    return { value: String(value), label: String(label) };\r\n  }\r\n\r\n  async deleteRow(id) {\r\n    if (!confirm('\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u043B\u0435\u043C\u0435\u043D\u0442?')) return;\r\n    try {\r\n      const res = await this.apis.apiDelete(id);\r\n      const ok = (res === true) || (res && (res.success === true || res.ok === true || res.deleted === id));\r\n      if (!ok) this.warn('delete returned ambiguous response', res);\r\n      this.data = this.data.filter(d => String(d[this.idField]) !== String(id));\r\n      this.applyFiltersAndRender();\r\n    } catch (err) { this.error('deleteRow error', err); alert('\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438. \u0421\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u043A\u043E\u043D\u0441\u043E\u043B\u044C.'); }\r\n  }\r\n\r\n  async init() {\r\n    this._ensureEls();\r\n    await this.fetcher.fetchRefs();\r\n    const items = await this.fetcher.fetchItems();\r\n    this.data = Array.isArray(items) ? items.map(it => ({ ...it })) : [];\r\n    this.attachEvents();\r\n    this.applyFiltersAndRender();\r\n    this.log('initialized', this.meta());\r\n    return this;\r\n  }\r\n\r\n  async refresh() {\r\n    await this.fetcher.fetchRefs();\r\n    const items = await this.fetcher.fetchItems();\r\n    this.data = Array.isArray(items) ? items.map(it => ({ ...it })) : [];\r\n    this.applyFiltersAndRender();\r\n    this.log('refreshed');\r\n  }\r\n\r\n  clearRefs() { this.refs = {}; this._refsLoaded = false; this._refsLoading = null; this.log('refs cache cleared'); }\r\n\r\n  destroy() {\r\n    this.detachEvents();\r\n    if (this._modal) this.modal._closeModal();\r\n    try { if (this._els._customLoading) this._els._customLoading.remove(); } catch (e) {}\r\n    try { if (this._els._autoLoading) this._els._autoLoading.remove(); } catch (e) {}\r\n    // cleanup price mask listeners (best-effort)\r\n    try {\r\n      document.querySelectorAll('input.bt-field-price').forEach(el => { try { el.removeEventListener('input', this._livePriceInputHandler); this._priceMaskCleanup(el); } catch (e) {} });\r\n    } catch (e) {}\r\n    this._els = {}; this.data = []; this.refs = {}; this.state = { q: '', sortBy: null, sortDir: 1 };\r\n    this.log('destroyed');\r\n  }\r\n}"],
  "mappings": "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",
  "names": ["control", "e", "makeRow", "f", "idx", "arr", "item", "li", "BaseTable", "e"]
}
